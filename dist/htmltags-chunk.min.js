(this.webpackChunkCoCreate=this.webpackChunkCoCreate||[]).push([[1305],{54905:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const o={attribute:"data-actions",actions:{},selectedStage:[],stageIndex:0,selectedElement:null,completedEventName:"completedEvent",__init:function(){this.actionButtonEvent()},actionButtonEvent:function(){const t=this;document.addEventListener("click",(function(e){let n=e.target;if(n.getAttribute("data-actions")||(n=e.target.closest("[data-actions]")),!n)return;e.preventDefault();let o=(n.getAttribute(t.attribute)||"").replace(/\s/g,"").split(",");0!=o.length&&(t.stageIndex=0,t.selectedStage=o,t.selectedElement=n,t.__runActionFunc())}))},init:function({action:t,callback:e,endEvent:n}){this.registerEvent(t,e,null,n)},registerEvent:function(t,e,n,o){if(this.actions[t])return;this.actions[t]={key:t,runFunc:e,instance:n||window,endEvent:o};for(let e in this.actions)if(e!=t&&this.actions[e].endEvent===o)return;const i=this;document.addEventListener(o,(function(t){i.__nextAction(o,t.detail)}))},__runActionFunc:function(t){if(this.stageIndex>=this.selectedStage.length)return void(this.stageIndex==this.selectedStage.length&&this.__runAtag(this.selectedElement));const e=this.selectedStage[this.stageIndex],n=this.actions[e];if(n)n.runFunc?n.runFunc.call(null,this.selectedElement,t):this.__nextAction(n.endEvent,{});else{"next"===this.__runSpecialAction(e,t)&&this.__moveNextAction()}},__nextAction:function(t,e){const n=this.selectedStage[this.stageIndex];n&&t===this.actions[n].endEvent&&this.__moveNextAction(e)},__runAtag:function(t){t.querySelector("a")},__runSpecialAction:function(t,e){let n=/(\w+)\{([a-zA-Z0-9_ \-#$.]+)\}/gm.exec(t);if(!n||n.length<3)return"next";let o=n[1],i=n[2].trim();if(!i)return"next";const r=this;switch(o){case"event":document.addEventListener(i,(t=>{r.__moveNextAction(t)}),{once:!0});break;case"timeout":parseInt(i)>0&&setTimeout((function(){r.__moveNextAction(e)}),parseInt(i));break;case"action":let t=document.querySelector(i);t&&t.click();break;default:return"next"}},__moveNextAction:function(t){this.stageIndex++,this.__runActionFunc(t)}};o.__init();const i=o},65797:function(t,e,n){var o,i;"undefined"!=typeof self&&self,o=[n(548),n(89655)],void 0===(i=function(t,e){return function(t,e,n){return{socket:null,setSocket:function(t){this.socket=t},readDocumentList(t){if(!t)return;let n=e.getCommonParams();t.collection&&t.operator&&(n={...n,...t},this.socket.send("readDocumentList",n))},createDocument:function(n){if(null===n)return;let o=e.getCommonParamsExtend(n),i={...n,...o},r=n.data||{};r.organization_id||(r.organization_id=t.config.organization_Id),n.data&&(r={...r,...n.data}),i.data=r;const a=e.generateSocketClient(n.namespace,n.room);this.socket.send("createDocument",i,a)},updateDocument:function(t){if(!t||!n.checkDocumentId(t.document_id))return;let o=e.getCommonParamsExtend(t),i={...t,...o};if("object"==typeof t.data&&(i.set=t.data),Array.isArray(t.delete_fields)&&(i.unset=t.delete_fields),!i.set&&!i.unset)return;!1===t.broadcast&&(i.broadcast=!1),void 0===t.broadcast_sender&&(i.broadcast_sender=!0);const r=e.generateSocketClient(t.namespace,t.room);this.socket.send("updateDocument",i,r)},readDocument:function(t){if(null===t)return;if(!t||!n.checkDocumentId(t.document_id))return;let o=e.getCommonParamsExtend(t),i={...t,...o};this.socket.send("readDocument",i)},deleteDocument:function(t){if(!t||!n.checkDocumentId(t.document_id))return;let o=e.getCommonParamsExtend(t),i={...t,...o};const r=e.generateSocketClient(t.namespace,t.room);this.socket.send("deleteDocument",i,r)},exportCollection:function(t){if(null===t)return;let n=e.getCommonParamsExtend(t);n.collection=t.collection,n.export_type=t.export_type,n.metadata=t.metadata,this.socket.send("exportDB",n)},importCollection:function(n){const{file:o}=n;if(null===n||!(o instanceof t.File))return;const i=o.name.split(".").pop();if(!["json","csv"].some((t=>t===i)))return;let r=e.getCommonParamsExtend(n);r.collection=n.collection,r.import_type=i,this.socket.send("importDB",r),this.socket.sendFile(o)},listen:function(t,e){this.socket.listen(t,e)},listenAsync:function(t){return this.socket.listenAsync(t)},createSocket:function(t,e){e?(this.socket.create({namespace:e,room:null,host:t}),this.socket.setGlobalScope(e)):this.socket.create({namespace:null,room:null,host:t})},...n}}(window,t,e)}.apply(e,o))||(t.exports=i)},93444:function(t,e,n){var o,i;"undefined"!=typeof self&&self,o=[n(5887),n(65797)],void 0===(i=function(t,e){return function(t,e,n){if(t){let t=new e("ws");n.setSocket(t),n.createSocket(window.config.host?window.config.host:window.location.hostname,window.config.organization_Id)}return n}(!0,t,e)}.apply(e,o))||(t.exports=i)},89655:function(t,e){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(){function t(e,n){e=e||{};for(let o of Object.keys(n))n[o]instanceof Object&&Object.assign(n[o],t(e[o],n[o]));return Object.assign(e||{},n),e}function e(t,e){if(!e)return t;let n=e.split("."),o=t;for(var i=n.length-1;i>=0;i--)o={[n[i]]:o};return o}function n(t,e){try{let n=/([\w\W]+)\[(\d+)\]/gm.exec(t);if(n&&3==n.length){let o=n[1],i=parseInt(n[2]);e[o]&&Array.isArray(e[o])||(e[o]=[]),e[o][i]=e[t],delete e[t],t=o}}catch{}return t}function o(t){return!!t&&t.constructor===Object}function i(t){return!!t&&t.constructor===Array}function r(o){let i=Object.keys(o),r={};return i.forEach((i=>{if((i=n(i,o)).split(".").length>1){let n=e(o[i],i);delete o[i],r=t(r,n)}else r[i]=o[i]})),r}function a(t){let e=Object.keys(t),n={};return e.forEach((e=>{let r=t[e];if(o(t[e])){let o=a(t[e]);Object.keys(o).forEach((t=>{let i=o[t];n[t=e+"."+t]=i}))}else i(r)?r.forEach(((t,o)=>{n[`${e}[${o}]`]=t})):n[e]=t[e]})),n}function c(t){if(t)return{collection:t.getAttribute("data-collection"),document_id:t.getAttribute("data-document_id"),name:t.getAttribute("name")}}function s(t){return t?{is_realtime:m(t),is_save:u(t),is_read:l(t),is_update:d(t)}:{}}const l=t=>f(t,"data-read_value"),u=t=>f(t,"data-save_value"),d=t=>f(t,"data-update_value"),m=t=>!!t&&"false"!=t.getAttribute("data-realtime");function f(t,e){return!!t&&"false"!==t.getAttribute(e)}function h(t){return!!t&&!/{{\s*([\w\W]+)\s*}}/g.test(t)}function g(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e}catch(t){return!1}}function p(t){const{collection:e,document_id:n,name:o}=c(t);return!(g(e)||g(o)||!("INPUT"===t.tagName&&["text","email","tel","url"].includes(t.type)||"TEXTAREA"===t.tagName)||!o||!m(t)||"true"===t.getAttribute("data-unique")||"password"===t.type||!l(t))}function _(t){try{return!!t&&"null"!==t.toLowerCase()}catch(t){return!1}}return{decodeObject:r,encodeObject:a,getAttr:c,getFlagAttr:s,isRealtimeAttr:m,isReadAttr:l,isSaveAttr:u,isUpdateAttr:d,checkValue:h,isCRDT:p,checkDocumentId:_}}()}.apply(e,[]))||(t.exports=n)},93449:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i}),window.profiler={},window.counter=0,window.counter2=0,window.targets={},window.attributeName={},Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;--n>=0&&e.item(n)!==this;);return n>-1});const o={initTasks:new Map,attrTasks:new Map,rules:new Map,rulesArray:[],__init:function(){const t=this;new MutationObserver(((e,n)=>t.__callback(e,n))).observe(document.body,{attributes:!0,childList:!0,subtree:!0,characterData:!1,attributeOldValue:!0,characterData:!0})},init:function({observe:t,include:e,exclude:n,attributes:o,name:i,callback:r}){t.some((t=>"childList"==t))&&this.initTasks.set(r,{observe:t,include:e,exclude:n,attributes:o,name:i}),t.some((t=>"attributes"==t))&&this.attrTasks.set(r,{observe:t,include:e,exclude:n,attributes:o,name:i})},remove:function(t){this.initTasks.delete(t),this.attrTasks.delete(t)},addRule:function({include:t,exclude:e,name:n}){this.rules.set(n,{include:t,exclude:e}),this.rulesArray=Array.from(this.rules)},removeRule:function({name:t}){this.rules.delete(t),this.rulesArray=Array.from(this.rules)},__callback:function(t,e){window.counter++;for(let e of t)"childList"==e.type&&e.addedNodes.length>0&&this.__initCallback(e),"attributes"==e.type&&this.__attrCallback(e)},__initCallback:function(t){Array.from(t.addedNodes);this.initTasks.forEach((({observe:e,include:n,exclude:o,attributes:i,name:r},a)=>{t.addedNodes.forEach((e=>{e.tagName&&(!n||e.matches(n)||e.querySelector(n))&&(o&&(e.matches(o)||e.querySelector(o))||a.apply(null,[{type:t.type,target:e}]))}))}))},__attrCallback:function(t){for(let[e,{include:n,exclude:o}]of this.rulesArray){if(n&&!t.target.matches(n))return;if(o&&t.target.matches(o))return}this.attrTasks.forEach((({observe:e,include:n,exclude:o,attributes:i,name:r},a)=>{if((!i||!t.attributeName||i.includes(t.attributeName))&&(!n||t.target.matches(n))&&(!o||!t.target.matches(o))&&t.attributeName){t.target.getAttribute(t.attributeName)!=t.oldValue&&a.apply(null,[t])}}))},setInitialized:function(t,e){t["co_initialized_"+(e=e||"")]=!0},getInitialized:function(t,e){return!!t["co_initialized_"+(e=e||"")]}};o.__init();const i=o},548:function(t,e){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(t){function e(){let e={};return t&&t.config&&(e=t.config),{apiKey:e.apiKey,securityKey:e.securityKey,organization_id:e.organization_Id}}function n(e){let n={};return t&&t.config&&(n=t.config),{apiKey:e.apiKey||n.apiKey,securityKey:e.securityKey||n.securityKey,organization_id:e.organization_id||n.organization_Id}}function o(e,n){let o={};t&&t.config&&(o=t.config);let i=e||o.organization_Id,r=n||"";return r?`${i}/${r}`:i}function i(t=36){let e=(new Date).getTime(),n=0,o="uxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";if(t<=o.length)o=o.substr(0,t);else{let e=t-o.length,n="-xxxyyxxx",i=Math.floor(e/n.length);for(let t=0;t<i;t++)o+=n;i=e-i*n.length,o+=n.substr(0,i)}return o.replace(/[xy]/g,(function(t){var o=16*Math.random();return e>0?(o=(e+o)%16|0,e=Math.floor(e/16)):(o=(n+o)%16|0,n=Math.floor(n/16)),("x"==t?o:7&o|8).toString(16)}))}return{getCommonParams:e,getCommonParamsExtend:n,generateSocketClient:o,GenerateUUID:i}}(window)}.apply(e,[]))||(t.exports=n)},5887:function(t,e,n){var o,i;"undefined"!=typeof self&&self,o=[n(548)],void 0===(i=function(t){return function(t,e,n,o){class i{constructor(t="crud"){this.prefix=t||"crud",this.sockets=new Map,this.listeners=new Map,this.messageQueue=new Map,this.saveFileName="",this.globalScope=""}setGlobalScope(t){this.globalScope=`${this.prefix}/${t}`}getGlobalScope(){return this.globalScope}create(t){const{namespace:i,room:r}=t,a=this.getKey(i,r);let c,s=this;if(i&&this.setGlobalScope(i),this.sockets.get(a))return void(c=this.sockets.get(a));let l=e.location.protocol;"about:"===e.location.protocol&&(l=e.parent.location.protocol,t.host||(t.host=e.parent.location.host));let u="http:"===l?"ws":"wss";const d=t.port?t.port:8088;let m=`${u}://${e.location.host}:${d}/${a}`;t.host&&(m=t.host.includes("://")?`${t.host}/${a}`:t.host.includes(":")?`${u}://${t.host}/${a}`:`${u}://${t.host}:${d}/${a}`);try{c=new n(m)}catch(t){return}c.onopen=function(t){(s.messageQueue.get(a)||[]).forEach((t=>c.send(JSON.stringify(t)))),s.sockets.set(a,c),s.messageQueue.set(a,[])},c.onclose=function(e){switch(e.code){case 1e3:break;default:s.destroy(c,a),s.reconnect(c,t)}},c.onerror=function(e){s.destroy(c,a),s.reconnect(c,t)},c.onmessage=function(t){try{if(e.Blob&&t.data instanceof o)return void s.saveFile(t.data);let i=JSON.parse(t.data);if(i.data.event){if(e.CustomEvent){var n=new e.CustomEvent(i.data.event,{detail:i.data});return void e.document.dispatchEvent(n)}return void process.emit(i.data.event,i.data)}i.action;const r=s.listeners.get(i.action);if(!r)return;r.forEach((t=>{t(i.data,a)}))}catch(t){}}}send(e,n,o){const i={action:e,data:{...n,uid:t.GenerateUUID()}},r=this.getKeyByRoom(o),a=this.getByRoom(o);a?a.send(JSON.stringify(i)):this.messageQueue.get(r)?this.messageQueue.get(r).push(i):this.messageQueue.set(r,[i])}sendFile(t,e){const n=this.getByRoom(e);n&&n.send(t)}listen(t,e){this.listeners.get(t)?this.listeners.get(t).push(e):this.listeners.set(t,[e])}reconnect(t,e){let n=this;setTimeout((function(){n.create(e)}),1e3)}destroy(t,e){t&&(t.onerror=t.onopen=t.onclose=null,t.close(),t=null),this.sockets.get(e)&&this.sockets.delete(e)}destroyByKey(t){let e=this.sockets.get(t);e&&this.destroy(e,t)}getKey(t,e){let n=`${this.prefix}`;return t&&""!=t&&(n+=e&&""!=e?`/${t}/${e}`:`/${t}`),n}getByRoom(t){let e=this.getKeyByRoom(t);return this.sockets.get(e)}getKeyByRoom(t){let e=this.globalScope;return t&&(e=`${this.prefix}/${t}`),e}saveFile(t){if(e.document){const o=this.saveFileName||"downloadFile";var n=e.document.createElement("a");e.document.body.appendChild(n),n.style="display: none";let i=window.URL.createObjectURL(t);n.href=i,n.download=o,n.click(),e.URL.revokeObjectURL(i),this.saveFileName=""}}listenAsync(t){return new Promise(((n,o)=>{e.document?e.document.addEventListener(t,(function(t){n(t.detail)}),{once:!0}):process.once(t,(t=>{n(t)}))}))}}return i}(t,window,WebSocket,Blob)}.apply(e,o))||(t.exports=i)},46164:(t,e,n)=>{"use strict";function o(t=36){let e=(new Date).getTime(),n=window.performance&&window.performance.now&&1e3*window.performance.now()||0,o="uxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";if(t<=o.length)o=o.substr(0,t);else{let e=t-o.length,n="-xxxyyxxx",i=Math.floor(e/n.length);for(let t=0;t<i;t++)o+=n;i=e-i*n.length,o+=n.substr(0,i)}return o.replace(/[xy]/g,(function(t){var o=16*Math.random();if(e>0){o=(e+o)%16|0;e=Math.floor(e/16)}else{o=(n+o)%16|0;n=Math.floor(n/16)}return("x"==t?o:7&o|8).toString(16)}))}function i(t,e,n){if(e){if(t.classList.contains(e))return t;let n=t.parentNode;for(;null!=n&&n.classList;){if(n.classList.contains(e))return n;n=n.parentNode}}else if(n){if(n.every((e=>t.attributes.hasOwnProperty(e))))return t;let e=t.parentNode;for(;null!=e&&e.attributes;){if(n.every((t=>e.attributes.hasOwnProperty(t))))return e;e=e.parentNode}}return!1}function r(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e}catch(t){return!1}}function a(t){return t.getAttributeNames().reduce(((e,n)=>(e[n]=t.getAttribute(n),e)),{})}function c(t){return!!t&&!/{{\s*([\w\W]+)\s*}}/g.test(t)}function s(t){let e=[{document,window}];for(let t of document.querySelectorAll("iframe")){let n=t.contentDocument||t.contentWindow.document,o=t.contentWindow;e.push({document:n,window:o,frameElement:t})}let n=new Set;for(let o of e){let e=t(o);e&&"function"==typeof e[Symbol.iterator]?e.forEach((t=>n.add(t))):e&&n.add(e)}return Array.from(n)}function l(t){let e=[];do{if(!t||!t.tagName)return!1;let n=t.tagName.toLowerCase();if(t.id&&"BODY"!==t.tagName&&(n+="#"+t.id),t.classList.length&&"BODY"!==t.tagName&&t.classList.forEach((t=>{-1===t.indexOf(":")&&(n+="."+t)})),"BODY"!==t.tagName&&t.parentNode){let e=Array.prototype.indexOf.call(t.parentNode.children,t);n+=`:nth-child(${e+1})`}e.unshift(n),t=t.parentNode}while("HTML"!==t.tagName);return e.join(" > ")}function u(){let t=window;for(;t!==window.parent;)t=window.parent;return t}function d(t,e){let n;return s((t=>{t.document.contains(e)&&(n=t.frameElement)})),n}function m(t){let e=u;return t.forEach((t=>{e&&(e=e.querySelector(t))})),e}function*f(t,e){for(let n of t)n.selector&&e.matches(n.selector)&&(yield n)}function h(t,e,n,o){for(let i of f(o||window.elementConfig,t)){if(!0===i[e])return n(t,i);if(!1===i[e])return!1;if(void 0===i[e])continue;if(b(i[e]))return n(t,i,!0)}return!1}function g(t=10){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",o=n.length,i=0;i<t;i++)e+=n.charAt(Math.floor(Math.random()*o));return e+=(new Date).toTimeString().replace(/[\W_]+/g,"").substr(0,6)}function p(t){let e=(new DOMParser).parseFromString(t,"text/html");return e.head.children[0]?e.head.children[0]:e.body.children[0]}function _(t,e){return t.split(e).map((t=>t.trim()))}function y(t,e){return t.map((t=>t.trim())).join(e)}function b(t){try{document.createDocumentFragment().querySelector(t)}catch(t){return!1}return!0}function x(t,e){let n=[],o=(window,d(0,t)),i=l(o);return i&&n.unshift(i),e?{path:n,document:o||document}:n}n.r(e),n.d(e,{generateUUID:()=>o,getParentFromElement:()=>i,isJsonString:()=>r,getAttributes:()=>a,checkValue:()=>c,allFrame:()=>s,cssPath:()=>l,getTopMostWindow:()=>u,findIframeFromElement:()=>d,getIframeFromPath:()=>m,configMatch:()=>f,configExecuter:()=>h,UUID:()=>g,parseTextToHtml:()=>p,splitBydelimiter:()=>_,joinBydelimiter:()=>y,isValidSelector:()=>b,getElementPath:()=>x,default:()=>v});const v={getElementPath:x,isValidSelector:b,joinBydelimiter:y,splitBydelimiter:_,parseTextToHtml:p,UUID:g,configExecuter:h,configMatch:f,getIframeFromPath:m,findIframeFromElement:d,getTopMostWindow:u,cssPath:l,allFrame:s,checkValue:c,getAttributes:a,isJsonString:r,getParentFromElement:i,generateUUID:o}},86492:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=c(n(93449)),i=c(n(54905)),r=c(n(46164)),a=c(n(93444));function c(t){return t&&t.__esModule?t:{default:t}}const s={selector:"h1, h2, h3, h4, h5, h6, p, i, q, a, b, li, span, code, html, head, meta, style, body, header, div, div.domEditor, iframe, img, nav, navbar, sidenav, menu, main, section, article, aside, dialog, details, label, strong",init:function(){this.__initAttribute(),this.__initSocket(),this.__initEvents(),this.initElement(document)},initElement:function(t){const e=this.__getReqeust(t);e&&e.length>0&&e.forEach((t=>{a.default.readDocument({collection:t.collection,document_id:t.document_id,metadata:t.metadata})}))},save:function(t,e,n){if("object"==typeof t){const e=new CustomEvent("changed-element",{});t.dispatchEvent(e)}if(!t.classList.contains("domEditor"))return;const{collection:o,document_id:i,name:r}=a.default.getAttr(t);let c=t.getAttribute("data-broadcast")||"true",s=t.getAttribute("data-namespace")||"",l=t.getAttribute("data-room")||"";c="true"===c,e||(e=c);let u="";u="IFRAME"===t.tagName?t.srcdoc:t.innerHTML,window.CoCreate.crdt?(window.CoCreateCrdt.init({collection:o,document_id:i,name:t}),window.CoCreate.crdt.replaceText({collection:o,document_id:i,name:r,value:u,updateCrud:!0,broadcast:e,broadcast_sender:n,upsert:!0})):a.default.updateDocument({namespace:s,room:l,collection:o,document_id:i,upsert:!0,broadcast_sender:n,data:{[r]:u},broadcast:e})},render:function(t,e){const n=this.__addAttributeSelectorTags(this.selector);let o=document.querySelectorAll(n),i=!1,r=!1;let c=a.default.encodeObject(t.data);if(o.forEach((n=>{const{collection:o,document_id:s,name:l}=a.default.getAttr(n),{is_read:u,is_update:d}=a.default.getFlagAttr(n),m=(t.metadata,n.getAttribute("data-request_id"));if(u&&(!e||d)&&!(m&&t.metadata&&t.metadata.request_id!==m||t.collection!=o||t.document_id!=s||n.isContentEditable)){const t=c[l];if(null==t)return;if("IMG"===n.tagName)n.src=t;else if("IFRAME"===n.tagName){n.srcdoc=t;let e=n;r=!0,n.onload=function(t){e.removeAttribute("srcdoc");let n=new CustomEvent("CoCreateHtmlTags-rendered",{detail:{window:e.contentWindow}});window.parent.dispatchEvent(n)}}else if("DIV"===n.tagName){if(n.hasAttribute("value")&&n.setAttribute("value",t),n.classList.contains("domEditor"))if("replace"==n.getAttribute("data-domEditor")){let e=document.createElement("div");e.innerHTML=t;let o=n.parentNode;o&&(e.children[0]?o.replaceChild(e.children[0],n):o.replaceChild(e,n))}else n.innerHTML=t}else n.innerHTML=t,n.hasAttribute("value")&&n.setAttribute("value",t);if("HEAD"==n.tagName||"BODY"==n.tagName){n.removeAttribute("data-collection"),n.removeAttribute("data-document_id"),n.removeAttribute("data-pass_id");for(var f=n.querySelectorAll("script"),h=0;h<f.length;h++){var g=document.createElement("script");g.type="text/javascript";var p=f[h].getAttribute("src"),_=f[h].innerHTML;""!=_&&(g.innerHTML=_),p&&(g.src=p),n.appendChild(g),f[h].remove()}}i=!0}})),i){const e=new CustomEvent("CoCreateHtmlTags-rendered",{eventType:"rendered",detail:{data:t}});document.dispatchEvent(e)}if(r){const e=new CustomEvent("CoCreateHtmlTags-iframe-rendered",{eventType:"rendered",detail:{data:t}});document.dispatchEvent(e)}},__getReqeust:function(t){let e=t||document;if(!e.querySelectorAll)return;const n=this.__addAttributeSelectorTags(this.selector);let i=e.querySelectorAll(n),r=[];return 0==i.length&&e!=document&&e.hasAttribute("data-document_id")&&(i=[e]),i.forEach((t=>{if(o.default.getInitialized(t,"htmltags"))return;const{collection:e,document_id:n}=a.default.getAttr(t),i=a.default.isReadAttr(t),c=t.getAttribute("data-request_id");if(i&&a.default.checkValue(n)&&c)return o.default.setInitialized(t,"htmltags"),void r.push({collection:e,document_id:n,metadata:{request_id:c}});i&&a.default.checkValue(n)&&!r.some((t=>t.collection===e&&t.document_id===n))&&r.push({collection:e,document_id:n})})),r},__initAttribute:function(t){const e=t||document;if(!e.querySelectorAll)return;const n=this.__addAttributeSelectorTags(this.selector);let o=e.querySelectorAll(n);0==o.length&&e!=document&&e.hasAttribute("data-document_id")&&(o=[e]),o.forEach((t=>{const{collection:e,document_id:n,name:o}=a.default.getAttr(t);e&&n&&o&&null==t.getAttribute("data-realtime")&&t.setAttribute("data-realtime",!0)}))},__initSocket:function(){const t=this;a.default.listen("updateDocument",(function(e){t.render(e,!0)})),a.default.listen("readDocument",(function(e){t.render(e)}))},__initEvents:function(){window.addEventListener("newCoCreateCssStyles",(function(t){const{isOnload:e,styleList:n}=t.detail;let o=document.querySelector("link[data-collection][data-document_id][name]");if(o){const{collection:t,document_id:e,name:i}=a.default.getAttr(o),{is_read:r,is_update:c}=a.default.getFlagAttr(o);c&&a.default.updateDocument({collection:t,document_id:e,upsert:!0,broadcast_sender:!1,data:{[i]:n},broadcast:!1})}}))},__addAttributeSelectorTags:function(t){return t.trim().split(/\s*,\s*/).map((function(t){return t+"[data-collection][data-document_id][name]"})).join(", ")},findElementByChild:function(t){return r.default.getParentFromElement(t,"domEditor")},__getValueFromJonDeep:function(t,e){try{if(void 0===t)return!1;let n=e.split("."),o=n.shift();return n.length>0?this.__getValueFromJonDeep(t[o],n.join(".")):t[o]}catch(t){return!1}}};s.init(),o.default.init({name:"CoCreateHtmlTags",observe:["subtree","childList"],include:"[data-collection][data-document_id][name]",callback:function(t){s.initElement(t.target)}}),i.default.init({action:"saveHtml",endEvent:"changed-element",callback:(t,e)=>{let n=t.closet("form");s.save(n)}});var l=s;e.default=l}}]);
(this.webpackChunkCoCreate=this.webpackChunkCoCreate||[]).push([[1272],{9844:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>u});var i=a(366),s=a(6515),n=(a(4727),a(5611)),o=a.n(n);const l={mainInfo:{},init:function(){const t=this;o().listen("updateDocument",(function(e){t.render(e)})),o().listen("readDocument",(function(e){t.render(e)})),o().listen("connect",(function(e){t.__getRequest()}))},initElement:function(t){const e=this.__getRequest(t);e&&e.forEach((t=>{o().readDocument({collection:t.collection,document_id:t.document_id})}))},render:function(t){const e=t.collection,a=t.document_id;for(let i in t.data){const s=this.__makeKey(e,a,i),n=t.data[i];this.mainInfo[s]&&this.mainInfo[s].forEach((t=>{t.el.setAttribute(t.attr,n),t.el.dispatchEvent(new CustomEvent("CoCreateAttribute-run",{eventType:"rendered",item:t.el}))}))}},setValue:function(t,e){},__getRequest:function(t){let e=t||document,a=e.querySelectorAll("[fetch-for]"),i=this,s=[];return 0===a.length&&e!=document&&e.hasAttributes("fetch-for")&&(a=[e]),a.forEach((t=>{const e=t.getAttribute("data-collection"),a=t.getAttribute("data-document_id"),n=t.getAttribute("name"),o=t.getAttribute("value"),l=t.attributes;for(let r=0;r<l.length;r++){let u=i.__jsonParse(l[r].value);if(u){let c=u.collection||e,d=u.document_id||a,_=u.name||n,f=u.value||o;if(u["data-pass_id"]){let t=i.__checkPassId(u["data-pass_id"]);t?(c=t.collection,d=t.document_id,f=t.value):(c=null,d=null,f=null)}const m=i.__makeKey(c,d,_);c&&d&&_&&(i.mainInfo[m]||(i.mainInfo[m]=[]),i.mainInfo[m].push({el:t,attr:l[r].name}),s.some((t=>t.collection===c&&t.document_id===d))||s.push({collection:c,document_id:d}))}}})),s},__jsonParse:function(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e?e:null}catch(t){return null}},__checkPassId:function(t){var e=localStorage.getItem("dataParams");if(!(e=JSON.parse(e))||0==e.length)return null;for(var a=0;a<e.length;a++)if(e[a].pass_to==t)return{collection:e[a].collection,document_id:e[a].document_id,value:e[a].value};return null},__makeKey:function(t,e,a){return`${t}_${e}_${a}`}};l.init(),i.default.init({name:"CoCreateLogicAttributes",observe:["addedNodes"],attributesFilter:["data-for"],callback:function(t){l.initElement(t.target)}});const r={attributes:l,init:function(){this.__initKeys(),this.__initPassSessionIds(),this.__initPassParams(),this.__initPassValueParams(),this.__initGetValueInput(),this.initAtagElement()},__initKeys:function(){window.localStorage.getItem("apiKey")&&(config.apiKey=window.localStorage.getItem("apiKey")),window.localStorage.getItem("securityKey")&&(config.securityKey=window.localStorage.getItem("securityKey")),window.localStorage.getItem("organization_id")&&(config.organization_Id=window.localStorage.getItem("organization_id"))},__initPassSessionIds:function(){let t=window.localStorage.getItem("organization_id"),e=window.localStorage.getItem("user_id"),a=window.localStorage.getItem("adminUI_id"),i=window.localStorage.getItem("builderUI_id");this.__initPassItems(t,".sessionOrg_Id",!0),this.__initPassItems(e,".sessionUser_Id"),this.__initPassItems(a,".sessionAdminUI_Id"),this.__initPassItems(i,".sessionBuilderUI_Id")},__initPassItems:function(t,e,a){const i=this;if(t){document.querySelectorAll(e).forEach((e=>{i.__setAttributeValueOfElement(e,"data-document_id",t),i.__setAttributeValueOfElement(e,"data-filter_value",t)}))}},initElement:function(t){const e=this;let a=t||document;if(!a.querySelectorAll)return;let s=a.querySelectorAll("[data-pass_id]");s=Array.from(s),a!=document&&a.hasAttribute("data-pass_id")&&s.push(a);let n=window.localStorage.getItem("dataParams");n=JSON.parse(n),n&&0!=n.length&&s.forEach((t=>{if(i.default.getInitialized(t))return;const a=t.getAttribute("data-pass_id"),s=n.find((t=>t.pass_to==a));if(!s)return;const{collection:o,document_id:l,pass_to:r,prefix:u}=s;i.default.setInitialized(t),"FORM"===t.tagName&&!t.getAttribute("data-colleciton")&&o&&t.setAttribute("data-colleciton",o),e.__setPassAttributes(t,s)}))},initAtagElement:function(){const t=this;document.addEventListener("click",(function(e){const a=e.target.closest("a, button");if(!a)return;if("modal"===a.getAttribute("target")&&a.getAttribute("data-pass_to"))return e.preventDefault(),void t.setLinkProcess(a);const i=a.getAttribute("href");if("modal"!==a.getAttribute("target")){if(a.hasAttribute("data-actions"))return;const s=a.getAttribute("data-pass_to");i?(e.preventDefault(),t.storePassData(a),t.openAnother(a)):(t.storePassData(a),s&&t.__initPassParams(s))}}))},__initPassParams:function(t){var e=window.localStorage.getItem("dataParams");if(!(e=JSON.parse(e))||0==e.length)return;let a=this;e.forEach((function(e){var i=e.collection,s=(e.document_id,e.prefix,e.pass_to);t&&s!=t||(document.querySelectorAll("form").forEach((t=>{var e=t.getAttribute("data-pass_id");e&&e==s&&i&&""!=i&&(t.getAttribute("data-collection")||t.setAttribute("data-collection",i))})),document.querySelectorAll("[data-pass_id]").forEach((t=>{var i=t.getAttribute("data-pass_id");i&&i==s&&a.__setPassAttributes(t,e)})))}))},__initPassValueParams:function(t){var e=window.localStorage.getItem("valueParams");(e=JSON.parse(e))&&0!=e.length&&e.forEach((function(e){var a=e.pass_value_to;(t||document).querySelectorAll("[data-pass_value_id]").forEach((t=>{let i=t.getAttribute("data-pass_value_id");i&&i==a&&(["INPUT","TEXTAREA","SELECT"].includes(t.tagName)?(t.value=e.value,CoCreate.floatingLabel&&CoCreate.floatingLabel.update(t)):t.innerHTML=e.value)}))}))},__getPassAttributes:function(t){return{collection:t.getAttribute("data-pass_collection")||t.getAttribute("data-pass_fetch_collection"),document_id:t.getAttribute("data-pass_document_id"),name:t.getAttribute("data-pass_name"),value:t.getAttribute("data-pass_value"),pass_to:t.getAttribute("data-pass_to"),filter_name:t.getAttribute("data-pass_filter_name"),filter_value:t.getAttribute("data-pass_filter_value"),prefix:t.getAttribute("data-pass_prefix")||""}},__setPassAttributes:function(t,e){const{collection:a,document_id:i,name:s,value:n,pass_to:o,filter_name:l,filter_value:r,prefix:u}=e,c=t.getAttribute("data-pass_id"),d=!!t.hasAttribute("data-pass_refresh");c==o&&(a&&(this.__setAttributeValueOfElement(t,"data-collection",a,d),this.__setAttributeValueOfElement(t,"data-fetch_collection",a,d),this.__setAttributeValueOfElement(t,"data-pass_fetch_collection",a,d),this.__setAttributeValueOfElement(t,"data-pass_collection",a,d)),i&&(this.__setAttributeValueOfElement(t,"data-document_id",i,d),this.__setAttributeValueOfElement(t,"data-fetch_document_id",i,d),this.__setAttributeValueOfElement(t,"data-pass_fetch_document_id",i,d),this.__setAttributeValueOfElement(t,"data-pass_document_id",i,d)),s&&(this.__setAttributeValueOfElement(t,"name",s,d),this.__setAttributeValueOfElement(t,"data-fetch_name",s,d),this.__setAttributeValueOfElement(t,"data-pass_name",s,d)),n&&(this.__setAttributeValueOfElement(t,"value",n,d),this.__setAttributeValueOfElement(t,"data-pass_value",n,d)),u&&(this.__setAttributeValueOfElement(t,"name",u+t.getAttribute("name"),d,!0),this.__setAttributeValueOfElement(t,"data-fetch_name",u+t.getAttribute("data-fetch_name"),d,!0),this.__setAttributeValueOfElement(t,"data-pass_prefix",u,d)),l&&(this.__setAttributeValueOfElement(t,"data-filter_name",l,d),this.__setAttributeValueOfElement(t,"data-pass_filter_name",l,d)),r&&(this.__setAttributeValueOfElement(t,"data-filter_value",r,d),this.__setAttributeValueOfElement(t,"data-pass_filter_value",r,d)))},__setAttributeValueOfElement:function(t,e,a,i,s){if(a){if(t.hasAttribute(e)&&s)return void t.setAttribute(e,a);if(t.hasAttribute(e)&&(!t.getAttribute(e)||i))return void t.setAttribute(e,a)}},storePassData:function(t){let e=[];const a=this;let i=this.__getPassAttributes(t);t.hasAttribute("data-actions")||(i.pass_to&&e.push(i),t.querySelectorAll("[data-pass_to]").forEach((t=>{let i=a.__getPassAttributes(t);i.pass_to&&e.push(i)})),e.length>0&&localStorage.setItem("dataParams",JSON.stringify(e)))},__initGetValueInput:function(){var t=document.querySelectorAll("input, textarea");let e=this;for(var a=0;a<t.length;a++){var i=t[a];i.id&&(i.addEventListener("input",(function(t){e.__setGetValueProcess(this.id,this.value)})),i.addEventListener("updated_by_fetch",(function(t){e.__setGetValueProcess(this.id,this.value)})))}},passProcessAction:function(t){let e=t.closest("form");if(!e)return;let a=e.querySelectorAll("input, textarea, select"),i=[];a.forEach((t=>{const e=t.getAttribute("data-pass_value_to"),a=t.value;e&&i.push({pass_value_to:e,value:a})})),i.length>0&&window.localStorage.setItem("valueParams",JSON.stringify(i)),this.__initPassValueParams(),document.dispatchEvent(new CustomEvent("passValueActionEnd",{detail:{}}))},setDataPassValues:function(t){const e=[];for(let a in t)e.push({pass_value_to:a,value:t[a]});e.length>0&&window.localStorage.setItem("valueParams",JSON.stringify(e))},initDataPassValues:function(){window.localStorage.removeItem("valueParams")},openAnother:function(t){var e=t.getAttribute("href"),a=t.getAttribute("target");"_blank"==a?window.open(e,"_blank"):"_window"==a?window.open(e,"_blank","location=yes,height=570,width=520,scrollbars=yes,status=yes"):window.open(e,"_self")},setLinkProcess:function(t){if(t.hasAttribute("data-actions"))return;const e=t.getAttribute("data-pass_to"),a=t.getAttribute("href");this.storePassData(t),this.checkOpenCocreateModal(t)?void 0!==CoCreate.modal&&CoCreate.modal.open(t):a?this.openAnother(t):e&&this.__initPassParams(e)},checkOpenCocreateModal:function(t){return"modal"===t.getAttribute("target")},__setGetValueProcess:function(t,e){t&&document.querySelectorAll('[data-get_value="'+t+'"]').forEach((t=>{if(void 0!==t.value?t.value=e:void 0!==t.textContent&&(t.textContent=e),CoCreate.floatingLabel&&CoCreate.floatingLabel.update(t),t.dispatchEvent(new Event("input",{bubbles:!0})),t.classList.contains("searchInput")){let e=new KeyboardEvent("keydown",{keyCode:13});t.dispatchEvent(e)}}))}};r.init(),i.default.init({name:"CoCreateAttributes",observe:["addedNodes"],attributesFilter:["data-for"],callback:function(t){let e=t.target;r.attributes.initElement(e)}}),i.default.init({name:"CoCreateLogic",observe:["addedNodes"],attributesFilter:["data-pass_id"],callback:function(t){r.initElement(t.target)}}),s.default.init({action:"passValueAction",endEvent:"passValueActionEnd",callback:(t,e)=>{r.passProcessAction(t)}});const u=r}}]);
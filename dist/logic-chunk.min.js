(this.webpackChunkCoCreate=this.webpackChunkCoCreate||[]).push([[1272],{5006:function(t,e,a){var n,i;"undefined"!=typeof self&&self,n=[a(9446),a(6092)],void 0===(i=function(t,e){return function(t,e,a){return{socket:null,setSocket:function(t){this.socket=t},readDocumentList(t){if(!t)return;let a=e.getCommonParams();t.collection&&t.operator&&(a={...a,...t},this.socket.send("readDocumentList",a))},createDocument:function(a){if(null===a)return;let n=e.getCommonParamsExtend(a),i={...a,...n},s=a.data||{};s.organization_id||(s.organization_id=t.config.organization_Id),a.data&&(s={...s,...a.data}),i.data=s;const o=e.generateSocketClient(a.namespace,a.room);this.socket.send("createDocument",i,o)},updateDocument:function(t){if(!t||!a.checkDocumentId(t.document_id))return;let n=e.getCommonParamsExtend(t),i={...t,...n};if("object"==typeof t.data&&(i.set=t.data),Array.isArray(t.delete_fields)&&(i.unset=t.delete_fields),!i.set&&!i.unset)return;!1===t.broadcast&&(i.broadcast=!1),void 0===t.broadcast_sender&&(i.broadcast_sender=!0);const s=e.generateSocketClient(t.namespace,t.room);this.socket.send("updateDocument",i,s)},readDocument:function(t){if(null===t)return;if(!t||!a.checkDocumentId(t.document_id))return;let n=e.getCommonParamsExtend(t),i={...t,...n};this.socket.send("readDocument",i)},deleteDocument:function(t){if(!t||!a.checkDocumentId(t.document_id))return;let n=e.getCommonParamsExtend(t),i={...t,...n};const s=e.generateSocketClient(t.namespace,t.room);this.socket.send("deleteDocument",i,s)},exportCollection:function(t){if(null===t)return;let a=e.getCommonParamsExtend(t);a.collection=t.collection,a.export_type=t.export_type,a.metadata=t.metadata,this.socket.send("exportDB",a)},importCollection:function(a){const{file:n}=a;if(null===a||!(n instanceof t.File))return;const i=n.name.split(".").pop();if(!["json","csv"].some((t=>t===i)))return;let s=e.getCommonParamsExtend(a);s.collection=a.collection,s.import_type=i,this.socket.send("importDB",s),this.socket.sendFile(n)},listen:function(t,e){this.socket.listen(t,e)},listenAsync:function(t){return this.socket.listenAsync(t)},createSocket:function(t,e){e?(this.socket.create({namespace:e,room:null,host:t}),this.socket.setGlobalScope(e)):this.socket.create({namespace:null,room:null,host:t})},...a}}(window,t,e)}.apply(e,n))||(t.exports=i)},7895:function(t,e,a){var n,i;"undefined"!=typeof self&&self,n=[a(8585),a(5006)],void 0===(i=function(t,e){return function(t,e,a){if(t){let t=new e("ws");a.setSocket(t),a.createSocket(window.config.host?window.config.host:window.location.hostname,window.config.organization_Id)}return a}(!0,t,e)}.apply(e,n))||(t.exports=i)},6092:function(t,e){var a;"undefined"!=typeof self&&self,void 0===(a=function(){return function(){function t(e,a){e=e||{};for(let n of Object.keys(a))a[n]instanceof Object&&Object.assign(a[n],t(e[n],a[n]));return Object.assign(e||{},a),e}function e(t,e){if(!e)return t;let a=e.split("."),n=t;for(var i=a.length-1;i>=0;i--)n={[a[i]]:n};return n}function a(t,e){try{let a=/([\w\W]+)\[(\d+)\]/gm.exec(t);if(a&&3==a.length){let n=a[1],i=parseInt(a[2]);e[n]&&Array.isArray(e[n])||(e[n]=[]),e[n][i]=e[t],delete e[t],t=n}}catch{}return t}function n(t){return!!t&&t.constructor===Object}function i(t){return!!t&&t.constructor===Array}function s(n){let i=Object.keys(n),s={};return i.forEach((i=>{if((i=a(i,n)).split(".").length>1){let a=e(n[i],i);delete n[i],s=t(s,a)}else s[i]=n[i]})),s}function o(t){let e=Object.keys(t),a={};return e.forEach((e=>{let s=t[e];if(n(t[e])){let n=o(t[e]);Object.keys(n).forEach((t=>{let i=n[t];a[t=e+"."+t]=i}))}else i(s)?s.forEach(((t,n)=>{a[`${e}[${n}]`]=t})):a[e]=t[e]})),a}function r(t){if(t)return{collection:t.getAttribute("data-collection"),document_id:t.getAttribute("data-document_id"),name:t.getAttribute("name")}}function l(t){return t?{is_realtime:_(t),is_save:c(t),is_read:u(t),is_update:d(t)}:{}}const u=t=>f(t,"data-read_value"),c=t=>f(t,"data-save_value"),d=t=>f(t,"data-update_value"),_=t=>!!t&&"false"!=t.getAttribute("data-realtime");function f(t,e){return!!t&&"false"!==t.getAttribute(e)}function m(t){return!!t&&!/{{\s*([\w\W]+)\s*}}/g.test(t)}function h(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e}catch(t){return!1}}function p(t){const{collection:e,document_id:a,name:n}=r(t);return!(h(e)||h(n)||!("INPUT"===t.tagName&&["text","email","tel","url"].includes(t.type)||"TEXTAREA"===t.tagName)||!n||!_(t)||"true"===t.getAttribute("data-unique")||"password"===t.type||!u(t))}function g(t){try{return!!t&&"null"!==t.toLowerCase()}catch(t){return!1}}return{decodeObject:s,encodeObject:o,getAttr:r,getFlagAttr:l,isRealtimeAttr:_,isReadAttr:u,isSaveAttr:c,isUpdateAttr:d,checkValue:m,isCRDT:p,checkDocumentId:g}}()}.apply(e,[]))||(t.exports=a)},9844:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>u});var n=a(366),i=a(6515),s=(a(4727),a(7895)),o=a.n(s);const r={mainInfo:{},init:function(){const t=this;o().listen("updateDocument",(function(e){t.render(e)})),o().listen("readDocument",(function(e){t.render(e)})),o().listen("connect",(function(e){t.__getRequest()}))},initElement:function(t){const e=this.__getRequest(t);e&&e.forEach((t=>{o().readDocument({collection:t.collection,document_id:t.document_id})}))},render:function(t){const e=t.collection,a=t.document_id;for(let n in t.data){const i=this.__makeKey(e,a,n),s=t.data[n];this.mainInfo[i]&&this.mainInfo[i].forEach((t=>{t.el.setAttribute(t.attr,s),t.el.dispatchEvent(new CustomEvent("CoCreateAttribute-run",{eventType:"rendered",item:t.el}))}))}},setValue:function(t,e){},__getRequest:function(t){let e=t||document,a=e.querySelectorAll("[fetch-for]"),n=this,i=[];return 0===a.length&&e!=document&&e.hasAttributes("fetch-for")&&(a=[e]),a.forEach((t=>{const e=t.getAttribute("data-collection"),a=t.getAttribute("data-document_id"),s=t.getAttribute("name"),o=t.getAttribute("value"),r=t.attributes;for(let l=0;l<r.length;l++){let u=n.__jsonParse(r[l].value);if(u){let c=u.collection||e,d=u.document_id||a,_=u.name||s,f=u.value||o;if(u["data-pass_id"]){let t=n.__checkPassId(u["data-pass_id"]);t?(c=t.collection,d=t.document_id,f=t.value):(c=null,d=null,f=null)}const m=n.__makeKey(c,d,_);c&&d&&_&&(n.mainInfo[m]||(n.mainInfo[m]=[]),n.mainInfo[m].push({el:t,attr:r[l].name}),i.some((t=>t.collection===c&&t.document_id===d))||i.push({collection:c,document_id:d}))}}})),i},__jsonParse:function(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e?e:null}catch(t){return null}},__checkPassId:function(t){var e=localStorage.getItem("dataParams");if(!(e=JSON.parse(e))||0==e.length)return null;for(var a=0;a<e.length;a++)if(e[a].pass_to==t)return{collection:e[a].collection,document_id:e[a].document_id,value:e[a].value};return null},__makeKey:function(t,e,a){return`${t}_${e}_${a}`}};r.init(),n.default.init({name:"CoCreateAttributes",observe:["subtree","childList"],include:"[data-for]",callback:function(t){r.initElement(t.target)}});const l={attributes:r,init:function(){this.__initKeys(),this.__initPassSessionIds(),this.__initPassParams(),this.__initPassValueParams(),this.__initGetValueInput(),this.initAtagElement()},__initKeys:function(){window.localStorage.getItem("apiKey")&&(config.apiKey=window.localStorage.getItem("apiKey")),window.localStorage.getItem("securityKey")&&(config.securityKey=window.localStorage.getItem("securityKey")),window.localStorage.getItem("organization_id")&&(config.organization_Id=window.localStorage.getItem("organization_id"))},__initPassSessionIds:function(){let t=window.localStorage.getItem("organization_id"),e=window.localStorage.getItem("user_id"),a=window.localStorage.getItem("adminUI_id"),n=window.localStorage.getItem("builderUI_id");this.__initPassItems(t,".sessionOrg_Id",!0),this.__initPassItems(e,".sessionUser_Id"),this.__initPassItems(a,".sessionAdminUI_Id"),this.__initPassItems(n,".sessionBuilderUI_Id")},initElement:function(t){const e=this;let a=t||document;if(!a.querySelectorAll)return;let i=a.querySelectorAll("[data-pass_id]");i=Array.from(i),a!=document&&a.hasAttribute("data-pass_id")&&i.push(a);let s=window.localStorage.getItem("dataParams");s=JSON.parse(s),s&&0!=s.length&&i.forEach((t=>{if(n.default.getInitialized(t))return;const a=t.getAttribute("data-pass_id"),i=s.find((t=>t.pass_to==a));if(!i)return;const{collection:o,document_id:r,pass_to:l,prefix:u}=i;n.default.setInitialized(t),"FORM"===t.tagName&&!t.getAttribute("data-colleciton")&&o&&t.setAttribute("data-colleciton",o),e.__setPassAttributes(t,i)}))},initAtagElement:function(){const t=this;document.addEventListener("click",(function(e){const a=e.target.closest("a, button");if(!a)return;if("modal"===a.getAttribute("target")&&a.getAttribute("data-pass_to"))return e.preventDefault(),void t.setLinkProcess(a);const n=a.getAttribute("href");if("modal"!==a.getAttribute("target")){if(a.hasAttribute("data-actions"))return;if(!t.passSubmitProcess(a))return;const i=a.getAttribute("data-pass_to");n?(e.preventDefault(),t.storePassData(a),t.openAnother(a)):(t.storePassData(a),i&&t.__initPassParams(i))}}))},__initPassParams:function(t){var e=window.localStorage.getItem("dataParams");if(!(e=JSON.parse(e))||0==e.length)return;let a=this;e.forEach((function(e){var n=e.collection,i=(e.document_id,e.prefix,e.pass_to);t&&i!=t||(document.querySelectorAll("form").forEach((t=>{var e=t.getAttribute("data-pass_id");e&&e==i&&n&&""!=n&&(t.getAttribute("data-collection")||t.setAttribute("data-collection",n))})),document.querySelectorAll("[data-pass_id]").forEach((t=>{var n=t.getAttribute("data-pass_id");n&&n==i&&a.__setPassAttributes(t,e)})))}))},__initPassValueParams:function(t){var e=window.localStorage.getItem("valueParams");(e=JSON.parse(e))&&0!=e.length&&e.forEach((function(e){var a=e.pass_value_to;(t||document).querySelectorAll("[data-pass_value_id]").forEach((t=>{let n=t.getAttribute("data-pass_value_id");n&&n==a&&(["INPUT","TEXTAREA","SELECT"].includes(t.tagName)?(t.value=e.value,CoCreate.floatingLabel&&CoCreate.floatingLabel.update(t)):t.innerHTML=e.value)}))}))},__getPassAttributes:function(t){return{collection:t.getAttribute("data-pass_collection")||t.getAttribute("data-pass_fetch_collection"),document_id:t.getAttribute("data-pass_document_id"),name:t.getAttribute("data-pass_name"),value:t.getAttribute("data-pass_value"),pass_to:t.getAttribute("data-pass_to"),filter_name:t.getAttribute("data-pass_filter_name"),filter_value:t.getAttribute("data-pass_filter_value"),prefix:t.getAttribute("data-pass_prefix")||""}},__setPassAttributes:function(t,e){const{collection:a,document_id:n,name:i,value:s,pass_to:o,filter_name:r,filter_value:l,prefix:u}=e,c=t.getAttribute("data-pass_id"),d=!!t.hasAttribute("data-pass_refresh");c==o&&(a&&(this.__setAttributeValueOfElement(t,"data-collection",a,d),this.__setAttributeValueOfElement(t,"data-fetch_collection",a,d),this.__setAttributeValueOfElement(t,"data-pass_fetch_collection",a,d),this.__setAttributeValueOfElement(t,"data-pass_collection",a,d)),n&&(this.__setAttributeValueOfElement(t,"data-document_id",n,d),this.__setAttributeValueOfElement(t,"data-fetch_document_id",n,d),this.__setAttributeValueOfElement(t,"data-pass_fetch_document_id",n,d),this.__setAttributeValueOfElement(t,"data-pass_document_id",n,d)),i&&(this.__setAttributeValueOfElement(t,"name",i,d),this.__setAttributeValueOfElement(t,"data-fetch_name",i,d),this.__setAttributeValueOfElement(t,"data-pass_name",i,d)),s&&(this.__setAttributeValueOfElement(t,"value",s,d),this.__setAttributeValueOfElement(t,"data-pass_value",s,d)),u&&(this.__setAttributeValueOfElement(t,"name",u+t.getAttribute("name"),d,!0),this.__setAttributeValueOfElement(t,"data-fetch_name",u+t.getAttribute("data-fetch_name"),d,!0),this.__setAttributeValueOfElement(t,"data-pass_prefix",u,d)),r&&(this.__setAttributeValueOfElement(t,"data-filter_name",r,d),this.__setAttributeValueOfElement(t,"data-pass_filter_name",r,d)),l&&(this.__setAttributeValueOfElement(t,"data-filter_value",l,d),this.__setAttributeValueOfElement(t,"data-pass_filter_value",l,d)))},__setAttributeValueOfElement:function(t,e,a,n,i){if(a){if(t.hasAttribute(e)&&i)return void t.setAttribute(e,a);if(t.hasAttribute(e)&&(!t.getAttribute(e)||n))return void t.setAttribute(e,a)}},storePassData:function(t){let e=[];const a=this;let n=this.__getPassAttributes(t);t.hasAttribute("data-actions")||(n.pass_to&&e.push(n),t.querySelectorAll("[data-pass_to]").forEach((t=>{let n=a.__getPassAttributes(t);n.pass_to&&e.push(n)})),e.length>0&&localStorage.setItem("dataParams",JSON.stringify(e)))},__initValuePassBtns:function(){},__initGetValueInput:function(){var t=document.querySelectorAll("input, textarea");let e=this;for(var a=0;a<t.length;a++){var n=t[a];n.id&&(n.addEventListener("input",(function(t){e.__setGetValueProcess(this.id,this.value)})),n.addEventListener("updated_by_fetch",(function(t){e.__setGetValueProcess(this.id,this.value)})))}},__registerValuePassBtnEvent:function(t,e){},passProcessAction:function(t){let e=t.closest("form");if(!e)return;let a=e.querySelectorAll("input, textarea, select"),n=[];a.forEach((t=>{const e=t.getAttribute("data-pass_value_to"),a=t.value;e&&n.push({pass_value_to:e,value:a})})),n.length>0&&window.localStorage.setItem("valueParams",JSON.stringify(n)),this.__initPassValueParams(),document.dispatchEvent(new CustomEvent("passValueActionEnd",{detail:{}}))},setDataPassValues:function(t){const e=[];for(let a in t)e.push({pass_value_to:a,value:t[a]});e.length>0&&window.localStorage.setItem("valueParams",JSON.stringify(e))},initDataPassValues:function(){window.localStorage.removeItem("valueParams")},openAnother:function(t){var e=t.getAttribute("href"),a=t.getAttribute("target");"_blank"==a?window.open(e,"_blank"):"_window"==a?window.open(e,"_blank","location=yes,height=570,width=520,scrollbars=yes,status=yes"):window.open(e,"_self")},setLinkProcess:function(t){if(t.hasAttribute("data-actions"))return;const e=t.getAttribute("data-pass_to"),a=t.getAttribute("href");this.storePassData(t),this.checkOpenCocreateModal(t)?void 0!==CoCreate.modal&&CoCreate.modal.open(t):a?this.openAnother(t):e&&this.__initPassParams(e)},checkOpenCocreateModal:function(t){return"modal"===t.getAttribute("target")},passSubmitProcess:function(t){return!t.parentNode.classList.contains("submitBtn")||!(!t.getAttribute("data-pass_to")||!t.getAttribute("data-pass_document_id"))},__setGetValueProcess:function(t,e){t&&document.querySelectorAll('[data-get_value="'+t+'"]').forEach((t=>{if(void 0!==t.value?t.value=e:void 0!==t.textContent&&(t.textContent=e),CoCreate.floatingLabel&&CoCreate.floatingLabel.update(t),t.dispatchEvent(new Event("input",{bubbles:!0})),t.classList.contains("searchInput")){let e=new KeyboardEvent("keydown",{keyCode:13});t.dispatchEvent(e)}}))},__initPassItems:function(t,e,a){const n=this;if(t){document.querySelectorAll(e).forEach((e=>{n.__setAttributeValueOfElement(e,"data-document_id",t),n.__setAttributeValueOfElement(e,"data-filter_value",t)}))}}};l.init(),n.default.init({name:"CoCreateAttributes",observe:["subtree","childList"],include:"[data-for]",callback:function(t){l.attributes.initElement(t.target)}}),n.default.init({name:"CoCreateLogic",observe:["subtree","childList"],include:"[data-pass_id]",callback:function(t){l.initElement(t.target)}}),i.default.init({action:"passValueAction",endEvent:"passValueActionEnd",callback:(t,e)=>{l.passProcessAction(t)}});const u=l}}]);
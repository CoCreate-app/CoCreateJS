(this.webpackChunkCoCreate=this.webpackChunkCoCreate||[]).push([[353],{8302:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>d});var n=a(5611),i=a.n(n),o=a(9484),r=a(6515);const c={masterDB:"5ae0cfac6fb8c4e656fdaf92",init:function(){config.organization_Id&&(this.masterDB=config.organization_Id);const t=this;i().listen("createOrg",(function(e){t.setDocumentId("organizations",e.document_id),document.dispatchEvent(new CustomEvent("createdOrg",{detail:e}))})),i().listen("createUser",(function(e){t.setDocumentId("users",e.document_id),document.dispatchEvent(new CustomEvent("createdUser",{detail:e}))}))},createOrg:function(t){let e=t.closest("form");if(!e)return;let a=e.querySelectorAll("[data-collection='organizations'][name]"),n={};a.forEach((t=>{let e=t.getAttribute("name"),a=o.default.getValue(t)||t.getAttribute("value");e&&a&&("array"==t.getAttribute("data-type")&&(a=[a]),n[e]=a)}));const r=config.organization_Id;i().socket.send("createOrg",{apiKey:config.apiKey,securityKey:config.securityKey,organization_id:config.organization_Id,db:this.masterDB,collection:"organizations",data:n},r)},setDocumentId:function(t,e){let a=document.querySelectorAll(`[data-collection='${t}']`);a&&a.length>0&&a.forEach((t=>{t.getAttribute("data-document_id")||t.setAttribute("data-document_id",e),"_id"==t.getAttribute("name")&&(t.value=e)}))},createUser:function(t,e){let a=t.closest("form");if(!a)return;let n="",r=a.querySelectorAll("[data-collection='users'][name]"),c=a.querySelector("input[data-collection='organizations'][name='_id']");c&&(n=c.value);let d={};r.forEach((t=>{let e=t.getAttribute("name"),a=o.default.getValue(t)||t.getAttribute("value");e&&a&&("array"==t.getAttribute("data-type")&&(a=[a]),d[e]=a)})),d.current_org=n,d.connected_orgs=[n],d.organization_id=n||config.organization_Id;const s=config.organization_Id;i().socket.send("createUser",{apiKey:config.apiKey,securityKey:config.securityKey,organization_id:config.organization_Id,db:this.masterDB,collection:"users",data:d,copyDB:n},s)}};c.init(),r.default.init({action:"createOrg",endEvent:"createdOrg",callback:(t,e)=>{c.createOrg(t)}}),r.default.init({action:"createUser",endEvent:"createdUser",callback:(t,e)=>{c.createUser(t)}});const d=c}}]);
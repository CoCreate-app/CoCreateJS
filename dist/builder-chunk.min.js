/*! For license information please see builder-chunk.min.js.LICENSE.txt */
(this.webpackChunkCoCreate=this.webpackChunkCoCreate||[]).push([[8653],{6279:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>K});var o=n(366),a=n(4752);function r(t){return new Promise((function(e){setTimeout((()=>{e()}),t)}))}let i,s,l,c;function u(t,e,n){let o=Object.assign({},t);o.collection=o.document_id,o.document_id="null",e.init(o);let a=n.createElement("div");return a.setAttribute("contenteditable",""),a.style.display="none",a.setAttribute("data-document_id",o.document_id),a.setAttribute("data-collection",o.collection),a.setAttribute("name",o.name),n.body.appendChild(a),o}i=document.querySelector("#canvas"),c={collection:i.getAttribute("data-collection"),document_id:i.getAttribute("data-document_id"),name:i.getAttribute("name")},window.crdtCon=c,a.default.init(c);u(c,a.default,document);const d=new Promise((async function(t,e){setTimeout((()=>{if(window.location.href.endsWith("/CoCreate-builder/dist/index.html")){for(;;){if(!a.default.getText({crud:!1,...c}))break;a.default.replaceText({crud:!1,...c,value:""}),r(200)}a.default.replaceText({crud:!1,...c,value:'<!DOCTYPE html><html>\n  \n\t<body data-element_id="body" style="padding:1;">\n\t\n\t\t<h1 name="4" class="color:red" data-element_id="445797c5-e01b-42cf-a8a5-f753ab60c8f6">test 5</h1>\n\t\t<h1 data-element_id="t1" name="1">test 1</h1>\n\t\t<h1 data-element_id="t3" name="3">test 3</h1>\n\t\t<h1 data-element_id="t2" name="2">test 2</h1>\n\t\t<h1 data-element_id="t4" name="4">test 4</h1>\n\t\t\n\t\t<script>\n        var config = {\n            apiKey: \'c2b08663-06e3-440c-ef6f-13978b42883a\',\n            organization_Id: \'5de0387b12e200ea63204d6c\',\n            host: \'wss://server.cocreate.app:8088\'\n        }\n    <\/script>\n    \n     <script src="./CoCreate-builder-canvas.js"><\/script>\n        \n   \n\t</body>\n</html>'})}let e=a.default.getText({crud:!1,...c}),n=document.createElement("iframe");n.srcdoc=e;for(let t of i.attributes)n.setAttribute(t.name,t.value);i.replaceWith(n),n.addEventListener("load",(()=>{n.removeAttribute("srcdoc"),l=n.contentWindow,s=l.document||n.contentDocument,s.ccdefaultView=l;let e=u(c,l.CoCreate.crdt,s);t({crdtCon:c,weirdCrdtCon:e,canvas:n,canvasDocument:s,canvasWindow:l})}))}),5e3)}));var p=n(2742);function h(t,e){return this.getAttribute(t)!==e&&(e?this.setAttribute(t,e):this.removeAttribute(t),!0)}function m({property:t,camelProperty:e,value:n,computedStyles:o}){return!(!o[e]||o[e]===n)&&(this.style[t]=n,!0)}function b(t){let e=parseFloat(t);if(isNaN(e))return[t,""];{let n=(e+"").length;return[e,t.substr(n)]}}function f(t){let e=0;for(;;){if(e=t.indexOf("-",e),-1===e)break;{let n=t.substring(0,e);n+=String.fromCharCode(t.charCodeAt(e+1)-32),n+=t.substr(e+2),t=n}}return t}var g=n(9612),v=n.n(g),y=n(5611),_=n.n(y),w=n(8858);let A={el:null,theme:"monolith",position:"bottom-start",defaultRepresentation:"HEX",inline:!1,comparison:!0,swatches:["rgba(244, 67, 54, 1)","rgba(233, 30, 99, 0.95)","rgba(156, 39, 176, 0.9)","rgba(103, 58, 183, 0.85)","rgba(63, 81, 181, 0.8)","rgba(33, 150, 243, 0.75)","rgba(3, 169, 244, 0.7)","rgba(0, 188, 212, 0.7)","rgba(0, 150, 136, 0.75)","rgba(76, 175, 80, 0.8)","rgba(139, 195, 74, 0.85)","rgba(205, 220, 57, 0.9)","rgba(255, 235, 59, 0.95)","rgba(255, 193, 7, 1)"],components:{preview:!0,opacity:!0,hue:!0,interaction:{hex:!0,rgba:!0,hsla:!0,hsva:!0,cmyk:!0,input:!0,clear:!1,save:!1}}},C=new Map;window.addEventListener("load",(()=>{let t=document.querySelectorAll(".color-picker");t.length&&t.forEach((t=>async function(t){let e,n=Array.from(t.attributes).filter((t=>t.name.startsWith("data")||t.name.startsWith("name"))),o=await _().read(t);if(o){let e=t.getAttribute("name");e&&o.data[e]&&(A.default=o.data[e])}A.el=t;let a=v().create(A),r=a.getRoot().root;async function i(t){var e=[{element:t.options.el,value:t.getColor().toHEXA().toString()}];await _().save(e)}n.forEach((t=>{r.setAttribute(t.name,t.value)})),C.set(r,{getColor:()=>a.getColor().toHEXA().toString(),setColor(t){window.aaa=[];let n=setInterval((()=>{window.aaa.push(t)}),1);setTimeout((()=>{clearInterval(n)}),1e3),e=!0,a.setColor(t),e=!1}}),a.on("change",((t,n,o)=>{if(t&&!e){let e=new CustomEvent("input",{bubbles:!0,detail:{color:t.toHEXA().toString()}});o.setColor(t.toHEXA().toString()),r.dispatchEvent(e)}})),a.on("changestop",((t,e)=>{i(e)})),a.on("swatchselect",((t,e)=>{i(e)}))}(t)))})),_().listen("updateDocument",(function(t){const{collection:e,document_id:n,data:o}=t;let a=document.querySelectorAll(`.pickr[data-collection="${e}"][data-document_id="${n}"]`);for(let t of a){const e=t.getAttribute("name");o[e]&&k.refs.get(t).setColor(o[e])}})),w.default.init({name:"CoCreatePickr",callback:t=>{let e=t.querySelectorAll(".color-picker");k.save(e)}});const k={refs:C},S=k;var E=n(980),$=n.n(E),x=n(602);let D=new function(){this.cache=new Map,this.spread=function(t,e){this.cache.set(t,{...this.cache.get(t),...e})},this.set=function(t,e,n){this.cache.set(t,{...this.cache.get(t),[e]:n})},this.get=function(t,e){let n=this.cache.get(t);return n?n[e]:void 0},this.reset=function(t){this.cache.delete(t)}},T=["attribute","classstyle","style","innerText"];function L({document:t,exclude:e="",callback:n=(()=>{})}){this.exclude=e,this.callback=n,this.initDocument=t}L.prototype.init=function(){this.scanNewElement(),o.default.init({name:"ccAttribute",observe:["attributes"],attributesFilter:["data-attributes_target","value","data-attributes_unit"],callback:async t=>t.target.matches("INPUT, .pickr, cocreate-select")&&await this.watchInputChange(t)}),this.initDocument.addEventListener("input",(async t=>{let e=t.target;this.perInput(e,((t,n)=>this.updateElement({...t,input:e,element:n,isColl:!0})))})),this.observerElements(this.initDocument.defaultView),$().listen("ccStyle",(t=>this.listen(t)))},L.prototype.listen=async function({value:t,unit:e,type:n,property:o,camelProperty:a,elementId:r,elementSelector:i}){let s=o?`[data-attributes="${n}"][data-attributes_property="${o}"]:not(${this.exclude})`:`[data-attributes="${n}"]:not(${this.exclude})`,l=this.initDocument.querySelector(s),c=await this.complexSelector(i,((t,e)=>t.querySelector(e)));this.updateElement({type:n,property:o,camelProperty:a,input:l,element:c,collValue:t,unit:e,isColl:!1})},L.prototype.collaborate=function({element:t,...e}){let n=t.getAttribute("data-element_id");if(!n)return;let o=e.input.getAttribute("data-attributes_target");$().send({broadcast_sender:!1,rooms:"",emit:{message:"ccStyle",data:{...e,elementId:n,elementSelector:o}}})},L.prototype.scanNewElement=function(){this.initDocument.querySelectorAll(`[data-attributes]:not(${this.exclude})`).forEach((async t=>{this.perInput(t,((e,n)=>this.updateInput({...e,input:t,element:n,isColl:!0})))}))},L.prototype.observerElements=function(t){t.CoCreate.observer.init({name:"ccAttribute",observe:["attributes"],callback:t=>{let e=t.target;this.getInputFromElement(e).forEach((t=>{let n=this.validateInput(t);n&&this.updateInput({...n,input:t,element:e})}))}})},L.prototype.getInputFromElement=function(t){let e=t.getAttribute("data-element_id")||t.id&&"#"+t.id;return e?this.initDocument.querySelectorAll(`[data-attributes_target="${e}"]`):[]},L.prototype.watchInputChange=async function(t){try{let e,n=t.target,o=this.validateInput(n);if(e=o&&await this.getElementFromInput(n),!e)return;"data-attributes_target"===t.attributeName?this.updateInput({...o,input:n,element:e}):"data-attributes_unit"===t.attributeName&&this.updateElement({...o,input:n,element:e,isColl:!0})}catch(t){}},L.prototype.perInput=async function(t,e){let n,o;n=this.validateInput(t),o=n&&await this.getElementFromInput(t),o&&e(n,o)},L.prototype.validateInput=function(t){let e=t.getAttribute("data-attributes");if(!e)return;e=e.toLowerCase();let n,o=t.getAttribute("data-attributes_property");return o&&(n=f(o),o=o.toLowerCase()),{type:e,property:o,camelProperty:n}},L.prototype.updateElementByValue=function({type:t,property:e,camelProperty:n,input:o,element:a,inputValue:r,hasCollValue:i}){let s,l,c;switch(t){case"classstyle":return c=o.getAttribute("data-attributes_unit")||"",l=(r=Array.isArray(r)?r.value:r)&&!i?r+c:r,l=l||"",s=this.getRealStaticCompStyle(a),function(t,{property:e,camelProperty:n,value:o,computedStyles:a}){let r=t.classList,i=new Map;r.forEach((t=>{let[e,n]=t.split(":");n&&i.set(e,n)}));let s=i.get(e);if(o){if(s){if(s!=o)return r.replace(`${e}:${s}`,`${e}:${o}`)}else if(a[n]!=o&&!r.contains(`${e}:${o}`))return r.add(`${e}:${o}`),!0}else if(r.contains(`${e}:${s}`))return r.remove(`${e}:${s}`),!0;return!1}(a,{property:e,camelProperty:n,value:l,computedStyles:s});case"style":return c=o.getAttribute("data-attributes_unit")||"",l=(r=Array.isArray(r)?r.value:r)&&!i?r+c:r,l=l||"",s=this.getRealStaticCompStyle(a),m.call(a,{property:e,camelProperty:n,value:l,computedStyles:s});case"innerText":return a.innerText!=r&&(a.innerText=r,!0);default:if("string"==typeof r)return h.call(a,t,r);if(!r.length)return h.call(a,t,"");if("class"===t)return l=r.map((t=>t.value)).join(" "),h.call(a,t,l);for(let e of r)if(e.checked)return h.call(a,t,e.value)}},L.prototype.removeZeros=function(t){let e=0;for(let n=t.length;e<n&&"0"===t[e];e++);return t.substr(e)||t&&"0"},L.prototype.updateElement=function({input:t,element:e,collValue:n,isColl:o,unit:a,type:r,property:i,...s}){let l=null!=n?n:this.getInputValue(t);if(!l)return;Array.isArray(l)?l.forEach((t=>this.removeZeros(t.value))):(l=a&&l?l+a:l,l=this.removeZeros(l));let c,u=this.updateElementByValue({...s,type:r,property:i,input:t,element:e,inputValue:l,hasCollValue:null!=n});D.reset(e),u&&o&&this.collaborate({value:l,unit:t.getAttribute("data-attributes_unit"),input:t,element:e,type:r,property:i,...s}),T.includes(r)||(i=r,r="attribute"),c=Array.isArray(l)?"class"===i?l.map((t=>t.value)).join(" "):l[0].value:l,u&&o&&this.callback({value:c,unit:t.getAttribute("data-attributes_unit"),input:t,element:e,type:r,property:i,...s})},L.prototype.updateInput=function({type:t,property:e,camelProperty:n,element:o,input:a}){let r,i,s,l,c;if(a){switch(t){case"class":i=Array.from(o.classList);break;case"classstyle":let e=function(t){let e={};return t.forEach((t=>{let[n,o]=t.split(":");e[f(n)]=o})),e}(o.classList);if(e[n]?s=e[n]:(r=this.getRealStaticCompStyle(o),s=r[n]),!s)return;[l,c]=b(s),i=l,h.call(a,"data-attributes_unit",c);break;case"style":if(r=this.getRealStaticCompStyle(o),s=r[n],!s)return;[l,c]=b(s),i=l,h.call(a,"data-attributes_unit",c);case"innerText":i=o.innerText;break;default:i=o.getAttribute(t)}this.setInputValue(a,null!=i?i:"")}},L.prototype.setInputValue=function(t,e){switch((t.classList.contains("pickr")?"pickr":t.matches(x.zO)&&"cocreate-select")||t.tagName.toLowerCase()){case"select":let n=Array.from(t.options);n.forEach((o=>{e==o.value&&(t.selectedIndex=n.indexOf(o))}));break;case"cocreate-select":e=e?Array.isArray(e)?e:[e]:[],function(t,e){if(p.container.has(t)){let n=p.container.get(t);e.length?e.forEach((t=>n.selectOption(t))):n.unselectAll(!1)}}(t,e);break;case"pickr":S.refs.get(t).setColor(e);break;default:a.default.replaceText({collection:"builder",document_id:"null",name:t.getAttribute("name"),value:e+"",position:"0"})}},L.prototype.packMultiValue=function({inputs:t,stateProperty:e,valueProperty:n="value",forceState:o}){let a=[];return Array.from(t).forEach((t=>{a.push({checked:o||t[e],value:t[n]||t.getAttribute(n)})})),a},L.prototype.getInputValue=function(t){if(!t)return;switch((t.classList.contains("pickr")?"pickr":t.matches(x.zO)&&"cocreate-select")||t.tagName.toLowerCase()){case"input":switch(t.type){case"checkbox":case"radio":return this.packMultiValue({inputs:this.initDocument.getElementsByName(t.name),stateProperty:"checked"});default:return t.value}case"textarea":return t.value;case"select":return this.packMultiValue({inputs:t.options,stateProperty:"selected"});case"cocreate-select":return this.packMultiValue({inputs:t.selectedOptions,forceState:!0});case"pickr":let e=S.refs.get(t);return e?e.getColor():"";default:return!1}},L.prototype.getElementFromInput=async function(t){let e=t.getAttribute("data-attributes_target");if(e){if(-1!==e.indexOf(";")){return await this.complexSelector(e,((t,e)=>t.querySelector(e)))}return this.initDocument.querySelector(e)}return!1},L.prototype.getRealStaticCompStyle=function(t){if(D.get(t,"valid"))return D.get(t,"computedStyles");setTimeout((()=>{D.reset(t)}),5e3);let e=t.style.display;t.style.display="none";let n=window.getComputedStyle(t),o=Object.assign({},n);return o.display=e,t.style.display=e,""==t.getAttribute("style")&&t.removeAttribute("style"),t.removeAttribute("no-observe"),D.spread(t,{computedStyles:o,valid:!0}),o};let O=new Map;L.prototype.complexSelector=async function(t,e){let[n,o]=t.split(";"),a=document.querySelector(n);if(a){if("loading"===a.contentDocument.readyState)try{await new Promise(((t,e)=>{a.contentWindow.addEventListener("load",(e=>t()))}))}catch(t){}return a.contentWindow.CoCreate.observer&&!O.has(a.contentWindow)&&(this.observerElements(a.contentWindow),O.set(a.contentWindow)),e(a.contentWindow.document,o)}};const P=t=>{let e=new L(t);return e.init(),e};var I=n(8249),j=n(4727);let N=(0,j.logger)("off");const R=d.then((function({crdtCon:t,canvas:e,canvasDocument:n,canvasWindow:o}){let r=a.default.getText({crud:!1,...t}),i=new I.default(r,n.documentElement);i.setCallback({addCallback:function({value:e,position:n,avoidTextToDom:o=!1}){a.default.getText({crud:!1,...t});CoCreate.crdt.insertText({crud:!1,...t,value:e,position:n})},removeCallback:function({from:e,to:n,avoidTextToDom:o=!1}){CoCreate.crdt.deleteText({crud:!1,...t,position:e,length:n-e})}});let s=new I.default(r,n.documentElement);return window.addEventListener("cocreate-crdt-update",(function(e){try{let e=event.detail;if(N.log("eee>>>>",event),e.collection!==t.collection||e.name!==t.name||e.document_id!==t.document_id)return;let n=e.eventDelta;for(let t=0;t<n.length;t++)if(n[t]?.attributes?.avoidTextToDom)return;let o=a.default.getText(t);s.html=i.html=o,window.savedDelta?window.savedDelta.push(n):window.savedDelta=[];let r=0;for(let t=0;t<n.length;t++)if(n[t].retain)r=n[t].retain;else if(n[t].insert){let e=n[t].insert;s.addToDom({pos:r,changeStr:e}),N.log(r,e)}else{let e=n[t].delete;s.removeFromDom({pos:r,removeLength:e}),N.log(r,e)}}catch(t){N.log("domText: text-to-dom: "+t)}})),i}));d.then((async function({crdtCon:t,canvas:e,canvasDocument:n,canvasWindow:o}){const a=await R;return P({document,exclude:"#ghostEffect, .vdom-item, #selectedElementcoc, #hoveredElementcoc",callback:({value:t,type:e,property:o,element:r,unit:i})=>{try{if(n.contains(r)){let n=r.getAttribute("data-element_id");switch(i=i||"",e){case"attribute":a.setAttribute({target:n,name:o,value:t});break;case"classstyle":a.setClassStyle({target:n,classname:o,value:t,unit:i});break;case"style":a.setStyle({target:n,styleName:o,value:t,unit:i});break;case"innerText":a.setInnerText({target:n,value:t});break;case"class":a.setClass({target:n,value:t})}}}catch(t){}}})}));var F=n(3501),H=n(212),B=n.n(H);const M=[{selector:"*",editable:!1,draggable:!0,droppable:!0,selectable:!0,hoverable:!0},{selector:"h1, h2, h3, h4, h5, h6, p, span, blockquote",editable:!0,draggable:!0,droppable:!1,selectable:!0,hoverable:!0},{selector:"input",editable:!1,draggable:!1,droppable:!1},{selector:"textarea",editable:!1},{selector:"select",editable:!1},{selector:"div.quill",draggable:!0,droppable:!1,selectable:!0,hoverable:!1},{selector:"div.nav",tagName:"navbar",draggable:!0,droppable:!0,selectable:!0,hoverable:!0},{selector:"div.floating-label_field",draggable:!0,droppable:!1,selectable:!1,hoverable:!1},{selector:"div.ql-editor *",draggable:!1,droppable:!1},{tagName:"icon",selector:"a.menu_icon",editable:!1,draggable:!1,droppable:!1,selectable:!0,hoverable:!0},{selector:"a.menu_icon span",selectable:!1,hoverable:!1},{selector:"menu_icon.span",editable:!1,draggable:!1,droppable:!1,selectable:!1,hoverable:!1,selectable2:!0}].reverse();window.elementConfig=M;const V=M;d.then((async function({crdtCon:t,canvas:e,canvasDocument:n,canvasWindow:o}){const a=await R;window.addEventListener("dndsuccess",(t=>{let{position:e,dragedEl:o,dropedEl:r,dropType:i,dragNextSib:s,dropNextSib:l}=t.detail;if(r.classList.contains("vdom-item")){let t=r.getAttribute("data-element_id");r=n.querySelector(`[data-element_id="${t}"]`),t=o.getAttribute("data-element_id"),o=n.querySelector(`[data-element_id="${t}"]`),r.insertAdjacentElement(e,o)}else if(!n.contains(r))return;try{switch(i){case"data-draggable":a.insertAdjacentElement({position:e,target:r.getAttribute("data-element_id"),element:o.getAttribute("data-element_id"),metadata:{type:"dnd"}});break;case"data-cloneable":a.insertAdjacentElement({position:e,target:r.getAttribute("data-element_id"),elementValue:o.outerHTML,metadata:{type:"dnd"}})}}catch(t){}})),F.default.initIframe({isIframe:!0,frame:e}),F.default.init({mode:"function",target:n,onDnd:(t,e)=>{for(let n of(0,j.configMatch)(V,t))for(let o of e)return!0===n[o.substr(5)]?[t,o]:void 0},onDndSuccess:t=>{t.dragedEl.getAttribute("data-element_id")||t.dragedEl.setAttribute("data-element_id",B().generate())}})}));var W=n(371);d.then((function({crdtCon:t,canvas:e,canvasDocument:n,canvasWindow:o}){W.default.init({selector:"#selectedElementcoc",eventType:"click",config:V,configKey:"selectable",document:n}),W.default.init({selector:"#hoveredElementcoc",eventType:"mouseover",config:V,configKey:"hoverable",document:n})}));var q=n(2671);d.then((function({crdtCon:t,canvas:e,canvasDocument:n,canvasWindow:o}){let a=document.querySelector("[data-vdom_target]"),r=document.querySelector("[data-vdom_id]");r=r.contentDocument.body.parentNode,a&&(a.innerText=""),r&&a&&(window.vdomObject=q.default.initVdom({realdom:r,virtualDom:a,ignore:"#dropMarker, script"}))}));var z=n(685);d.then((function({crdtCon:t,weirdCrdtCon:e,canvas:n,canvasDocument:o,canvasWindow:a}){z.default.config({srcDocument:o,destDocument:document,selector:"*",target:"[data-attributes]:not(.styleunit)",callback:(t,o)=>{o.setAttribute("name",o.id+"-"+t.getAttribute("data-element_id")),o.setAttribute("data-attributes_target",`#${n.id};[data-element_id="${t.getAttribute("data-element_id")}"]`),o.setAttribute("collection",e.collection)}}),z.default.config({srcDocument:o,destDocument:document,selector:"*",target:".styleunit",callback:(t,n)=>{n.setAttribute("name",n.id+"-"+t.getAttribute("data-element_id")),n.setAttribute("collection",e.collection)}})}));const X={auto:!0,inherit:!0,initial:!0};function U(t){let e=t.target;if(e.matches(x.zO)&&e.matches('[data-attributes="data-attributes_unit"]')){let t=e.selectedOptions[0];if(!t)return;let n=t.getAttribute("value");if(X[n]){p.container.get(e).unselectAll(!0);let t=e.getAttribute("data-attributes_target");if(!t)return;let o=document.querySelector(t);if(!o)return;a.default.replaceText({collection:"builder",document_id:"null",name:o.getAttribute("name"),value:n+"",position:"0"})}}}d.then((function({crdtCon:t,canvas:e,canvasDocument:n,canvasWindow:o}){document.addEventListener("input",U)})),d.then((async function({crdtCon:t,weirdCrdtCon:e,canvas:n,canvasDocument:o,canvasWindow:r}){const i=await R;o.addEventListener("dblclick",(t=>{let n=t.target;if(n.hasAttribute("contenteditable"))return;let o=n.innerText,r=n.getAttribute("data-element_id");n.setAttribute("contenteditable",!0),n.setAttribute("name",`innertext-${r}`),n.setAttribute("data-collection",e.collection),n.setAttribute("data-document_id",e.document_id),setTimeout((()=>{!a.default.getText(e)&&n.innerText||a.default.getText(e)&&!n.innerText||a.default.replaceText({crud:!1,...e,value:o})}),0),n.addEventListener("input",(()=>{i.setInnerText({target:r,value:n.innerText,avoidTextToDom:!0})}))}))}));document.querySelectorAll("textarea.clipboard").forEach((t=>{t.addEventListener("paste",(e=>{if(e.detail?.data)return;let n,o;e.stopPropagation(),e.preventDefault(),n=e.clipboardData||window.clipboardData,o=n.getData("Text");let a,[r,i]=function(t){let e,n=t.match(/\<(?<tag>[a-z0-9]+)(.*?)?\>/).groups.tag;if(!n)throw new Error("find position: can not find the main tag");switch(n){case"html":return e=(new DOMParser).parseFromString(t,"text/html"),[e.documentElement,!1];case"body":return e=(new DOMParser).parseFromString(t,"text/html"),[e.body,!1];case"head":return e=(new DOMParser).parseFromString(t,"text/html"),[e.head,!1];default:let n=document.createElement("div");return n.innerHTML=t,[n,!0]}}(o);r?(e.stopImmediatePropagation(),i||r.setAttribute("data-element_id",B().generate()),r.querySelectorAll("*").forEach((t=>t.setAttribute("data-element_id",B().generate()))),a=i?r.innerHTML:r.outerHTML,t.dispatchEvent(new CustomEvent("paste",{bubbles:!0,detail:{data:a}}))):a=o}))})),(async()=>{})();const K={observer:o.default,crdt:a.default}},9612:t=>{window,t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var o={};function a(t,e,n,o,a={}){e instanceof HTMLCollection||e instanceof NodeList?e=Array.from(e):Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);for(const r of e)for(const e of n)r[t](e,o,{capture:!1,...a});return Array.prototype.slice.call(arguments,1)}n.r(o),n.d(o,"on",(function(){return r})),n.d(o,"off",(function(){return i})),n.d(o,"createElementFromString",(function(){return s})),n.d(o,"createFromTemplate",(function(){return l})),n.d(o,"eventPath",(function(){return c})),n.d(o,"resolveElement",(function(){return u})),n.d(o,"adjustableInputNumbers",(function(){return d}));const r=a.bind(null,"addEventListener"),i=a.bind(null,"removeEventListener");function s(t){const e=document.createElement("div");return e.innerHTML=t.trim(),e.firstElementChild}function l(t){const e=(t,e)=>{const n=t.getAttribute(e);return t.removeAttribute(e),n},n=(t,o={})=>{const a=e(t,":obj"),r=e(t,":ref"),i=a?o[a]={}:o;r&&(o[r]=t);for(const o of Array.from(t.children)){const t=e(o,":arr"),a=n(o,t?{}:i);t&&(i[t]||(i[t]=[])).push(Object.keys(a).length?a:o)}return o};return n(s(t))}function c(t){let e=t.path||t.composedPath&&t.composedPath();if(e)return e;let n=t.target.parentElement;for(e=[t.target,n];n=n.parentElement;)e.push(n);return e.push(document,window),e}function u(t){return t instanceof Element?t:"string"==typeof t?t.split(/>>/g).reduce(((t,e,n,o)=>(t=t.querySelector(e),n<o.length-1?t.shadowRoot:t)),document):null}function d(t,e=(t=>t)){function n(n){const o=[.001,.01,.1][Number(n.shiftKey||2*n.ctrlKey)]*(n.deltaY<0?1:-1);let a=0,r=t.selectionStart;t.value=t.value.replace(/[\d.]+/g,((t,n)=>n<=r&&n+t.length>=r?(r=n,e(Number(t),o,a)):(a++,t))),t.focus(),t.setSelectionRange(r,r),n.preventDefault(),t.dispatchEvent(new Event("input"))}r(t,"focus",(()=>r(window,"wheel",n,{passive:!1}))),r(t,"blur",(()=>i(window,"wheel",n)))}const{min:p,max:h,floor:m,round:b}=Math;function f(t,e,n){e/=100,n/=100;const o=m(t=t/360*6),a=t-o,r=n*(1-e),i=n*(1-a*e),s=n*(1-(1-a)*e),l=o%6;return[255*[n,i,r,r,s,n][l],255*[s,n,n,i,r,r][l],255*[r,r,s,n,n,i][l]]}function g(t,e,n){const o=(2-(e/=100))*(n/=100)/2;return 0!==o&&(e=1===o?0:o<.5?e*n/(2*o):e*n/(2-2*o)),[t,100*e,100*o]}function v(t,e,n){const o=p(t/=255,e/=255,n/=255),a=h(t,e,n),r=a-o;let i,s;if(0===r)i=s=0;else{s=r/a;const o=((a-t)/6+r/2)/r,l=((a-e)/6+r/2)/r,c=((a-n)/6+r/2)/r;t===a?i=c-l:e===a?i=1/3+o-c:n===a&&(i=2/3+l-o),i<0?i+=1:i>1&&(i-=1)}return[360*i,100*s,100*a]}function y(t,e,n,o){return e/=100,n/=100,[...v(255*(1-p(1,(t/=100)*(1-(o/=100))+o)),255*(1-p(1,e*(1-o)+o)),255*(1-p(1,n*(1-o)+o)))]}function _(t,e,n){e/=100;const o=2*(e*=(n/=100)<.5?n:1-n)/(n+e)*100,a=100*(n+e);return[t,isNaN(o)?0:o,a]}function w(t){return v(...t.match(/.{2}/g).map((t=>parseInt(t,16))))}function A(t){t=t.match(/^[a-zA-Z]+$/)?function(t){if("black"===t.toLowerCase())return"#000";const e=document.createElement("canvas").getContext("2d");return e.fillStyle=t,"#000"===e.fillStyle?null:e.fillStyle}(t):t;const e={cmyk:/^cmyk[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)/i,rgba:/^((rgba)|rgb)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,hsla:/^((hsla)|hsl)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,hsva:/^((hsva)|hsv)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,hexa:/^#?(([\dA-Fa-f]{3,4})|([\dA-Fa-f]{6})|([\dA-Fa-f]{8}))$/i},n=t=>t.map((t=>/^(|\d+)\.\d+|\d+$/.test(t)?Number(t):void 0));let o;t:for(const a in e){if(!(o=e[a].exec(t)))continue;const r=t=>!!o[2]==("number"==typeof t);switch(a){case"cmyk":{const[,t,e,r,i]=n(o);if(t>100||e>100||r>100||i>100)break t;return{values:y(t,e,r,i),type:a}}case"rgba":{const[,,,t,e,i,s]=n(o);if(t>255||e>255||i>255||s<0||s>1||!r(s))break t;return{values:[...v(t,e,i),s],a:s,type:a}}case"hexa":{let[,t]=o;4!==t.length&&3!==t.length||(t=t.split("").map((t=>t+t)).join(""));const e=t.substring(0,6);let n=t.substring(6);return n=n?parseInt(n,16)/255:void 0,{values:[...w(e),n],a:n,type:a}}case"hsla":{const[,,,t,e,i,s]=n(o);if(t>360||e>100||i>100||s<0||s>1||!r(s))break t;return{values:[..._(t,e,i),s],a:s,type:a}}case"hsva":{const[,,,t,e,i,s]=n(o);if(t>360||e>100||i>100||s<0||s>1||!r(s))break t;return{values:[t,e,i,s],a:s,type:a}}}}return{values:null,type:null}}function C(t=0,e=0,n=0,o=1){const a=(t,e)=>(n=-1)=>e(~n?t.map((t=>Number(t.toFixed(n)))):t),r={h:t,s:e,v:n,a:o,toHSVA(){const t=[r.h,r.s,r.v,r.a];return t.toString=a(t,(t=>`hsva(${t[0]}, ${t[1]}%, ${t[2]}%, ${r.a})`)),t},toHSLA(){const t=[...g(r.h,r.s,r.v),r.a];return t.toString=a(t,(t=>`hsla(${t[0]}, ${t[1]}%, ${t[2]}%, ${r.a})`)),t},toRGBA(){const t=[...f(r.h,r.s,r.v),r.a];return t.toString=a(t,(t=>`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${r.a})`)),t},toCMYK(){const t=function(t,e,n){const o=f(t,e,n),a=o[0]/255,r=o[1]/255,i=o[2]/255,s=p(1-a,1-r,1-i);return[100*(1===s?0:(1-a-s)/(1-s)),100*(1===s?0:(1-r-s)/(1-s)),100*(1===s?0:(1-i-s)/(1-s)),100*s]}(r.h,r.s,r.v);return t.toString=a(t,(t=>`cmyk(${t[0]}%, ${t[1]}%, ${t[2]}%, ${t[3]}%)`)),t},toHEXA(){const t=function(t,e,n){return f(t,e,n).map((t=>b(t).toString(16).padStart(2,"0")))}(r.h,r.s,r.v),e=r.a>=1?"":Number((255*r.a).toFixed(0)).toString(16).toUpperCase().padStart(2,"0");return e&&t.push(e),t.toString=()=>"#"+t.join("").toUpperCase(),t},clone:()=>C(r.h,r.s,r.v,r.a)};return r}const k=t=>Math.max(Math.min(t,1),0);function S(t){const e={options:Object.assign({lock:null,onchange:()=>0,onstop:()=>0},t),_keyboard(t){const{options:n}=e,{type:o,key:a}=t;if(document.activeElement===n.wrapper){const{lock:n}=e.options,r="ArrowUp"===a,i="ArrowRight"===a,s="ArrowDown"===a,l="ArrowLeft"===a;if("keydown"===o&&(r||i||s||l)){let o=0,a=0;"v"===n?o=r||i?1:-1:"h"===n?o=r||i?-1:1:(a=r?-1:s?1:0,o=l?-1:i?1:0),e.update(k(e.cache.x+.01*o),k(e.cache.y+.01*a)),t.preventDefault()}else a.startsWith("Arrow")&&(e.options.onstop(),t.preventDefault())}},_tapstart(t){r(document,["mouseup","touchend","touchcancel"],e._tapstop),r(document,["mousemove","touchmove"],e._tapmove),t.cancelable&&t.preventDefault(),e._tapmove(t)},_tapmove(t){const{options:n,cache:o}=e,{lock:a,element:r,wrapper:i}=n,s=i.getBoundingClientRect();let l=0,c=0;if(t){const e=t&&t.touches&&t.touches[0];l=t?(e||t).clientX:0,c=t?(e||t).clientY:0,l<s.left?l=s.left:l>s.left+s.width&&(l=s.left+s.width),c<s.top?c=s.top:c>s.top+s.height&&(c=s.top+s.height),l-=s.left,c-=s.top}else o&&(l=o.x*s.width,c=o.y*s.height);"h"!==a&&(r.style.left=`calc(${l/s.width*100}% - ${r.offsetWidth/2}px)`),"v"!==a&&(r.style.top=`calc(${c/s.height*100}% - ${r.offsetHeight/2}px)`),e.cache={x:l/s.width,y:c/s.height};const u=k(l/s.width),d=k(c/s.height);switch(a){case"v":return n.onchange(u);case"h":return n.onchange(d);default:return n.onchange(u,d)}},_tapstop(){e.options.onstop(),i(document,["mouseup","touchend","touchcancel"],e._tapstop),i(document,["mousemove","touchmove"],e._tapmove)},trigger(){e._tapmove()},update(t=0,n=0){const{left:o,top:a,width:r,height:i}=e.options.wrapper.getBoundingClientRect();"h"===e.options.lock&&(n=t),e._tapmove({clientX:o+r*t,clientY:a+i*n})},destroy(){const{options:t,_tapstart:n,_keyboard:o}=e;i(document,["keydown","keyup"],o),i([t.wrapper,t.element],"mousedown",n),i([t.wrapper,t.element],"touchstart",n,{passive:!1})}},{options:n,_tapstart:o,_keyboard:a}=e;return r([n.wrapper,n.element],"mousedown",o),r([n.wrapper,n.element],"touchstart",o,{passive:!1}),r(document,["keydown","keyup"],a),e}function E(t={}){t=Object.assign({onchange:()=>0,className:"",elements:[]},t);const e=r(t.elements,"click",(e=>{t.elements.forEach((n=>n.classList[e.target===n?"add":"remove"](t.className))),t.onchange(e),e.stopPropagation()}));return{destroy:()=>i(...e)}}const $={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8},x=(t,e,n)=>{const o="object"!=typeof t||t instanceof HTMLElement?{reference:t,popper:e,...n}:t;return{update(t=o){const{reference:e,popper:n}=Object.assign(o,t);if(!n||!e)throw new Error("Popper- or reference-element missing.");return((t,e,n)=>{const{container:o,margin:a,position:r,variantFlipOrder:i,positionFlipOrder:s}={container:document.documentElement.getBoundingClientRect(),...$,...n},{left:l,top:c}=e.style;e.style.left="0",e.style.top="0";const u=t.getBoundingClientRect(),d=e.getBoundingClientRect(),p={t:u.top-d.height-a,b:u.bottom+a,r:u.right+a,l:u.left-d.width-a},h={vs:u.left,vm:u.left+u.width/2+-d.width/2,ve:u.left+u.width-d.width,hs:u.top,hm:u.bottom-u.height/2-d.height/2,he:u.bottom-d.height},[m,b="middle"]=r.split("-"),f=s[m],g=i[b],{top:v,left:y,bottom:_,right:w}=o;for(const t of f){const n="t"===t||"b"===t,o=p[t],[a,r]=n?["top","left"]:["left","top"],[i,s]=n?[d.height,d.width]:[d.width,d.height],[l,c]=n?[_,w]:[w,_],[u,m]=n?[v,y]:[y,v];if(!(o<u||o+i>l))for(const i of g){const l=h[(n?"v":"h")+i];if(!(l<m||l+s>c))return e.style[r]=l-d[r]+"px",e.style[a]=o-d[a]+"px",t+i}}return e.style.left=l,e.style.top=c,null})(e,n,o)}}};function D(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class T{constructor(t){D(this,"_initializingActive",!0),D(this,"_recalc",!0),D(this,"_nanopop",null),D(this,"_root",null),D(this,"_color",C()),D(this,"_lastColor",C()),D(this,"_swatchColors",[]),D(this,"_setupAnimationFrame",null),D(this,"_eventListener",{init:[],save:[],hide:[],show:[],clear:[],change:[],changestop:[],cancel:[],swatchselect:[]}),this.options=t=Object.assign({...T.DEFAULT_OPTIONS},t);const{swatches:e,components:n,theme:o,sliders:a,lockOpacity:r,padding:i}=t;["nano","monolith"].includes(o)&&!a&&(t.sliders="h"),n.interaction||(n.interaction={});const{preview:s,opacity:l,hue:c,palette:u}=n;n.opacity=!r&&l,n.palette=u||s||l||c,this._preBuild(),this._buildComponents(),this._bindEvents(),this._finalBuild(),e&&e.length&&e.forEach((t=>this.addSwatch(t)));const{button:d,app:p}=this._root;this._nanopop=x(d,p,{margin:i}),d.setAttribute("role","button"),d.setAttribute("aria-label",this._t("btn:toggle"));const h=this;this._setupAnimationFrame=requestAnimationFrame((function e(){if(!p.offsetWidth)return requestAnimationFrame(e);h.setColor(t.default),h._rePositioningPicker(),t.defaultRepresentation&&(h._representation=t.defaultRepresentation,h.setColorRepresentation(h._representation)),t.showAlways&&h.show(),h._initializingActive=!1,h._emit("init")}))}_preBuild(){const{options:t}=this;for(const e of["el","container"])t[e]=u(t[e]);this._root=(t=>{const{components:e,useAsButton:n,inline:o,appClass:a,theme:r,lockOpacity:i}=t.options,s=t=>t?"":'style="display:none" hidden',c=e=>t._t(e),u=l(`\n      <div :ref="root" class="pickr">\n\n        ${n?"":'<button type="button" :ref="button" class="pcr-button"></button>'}\n\n        <div :ref="app" class="pcr-app ${a||""}" data-theme="${r}" ${o?'style="position: unset"':""} aria-label="${c("ui:dialog")}" role="window">\n          <div class="pcr-selection" ${s(e.palette)}>\n            <div :obj="preview" class="pcr-color-preview" ${s(e.preview)}>\n              <button type="button" :ref="lastColor" class="pcr-last-color" aria-label="${c("btn:last-color")}"></button>\n              <div :ref="currentColor" class="pcr-current-color"></div>\n            </div>\n\n            <div :obj="palette" class="pcr-color-palette">\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="palette" class="pcr-palette" tabindex="0" aria-label="${c("aria:palette")}" role="listbox"></div>\n            </div>\n\n            <div :obj="hue" class="pcr-color-chooser" ${s(e.hue)}>\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="slider" class="pcr-hue pcr-slider" tabindex="0" aria-label="${c("aria:hue")}" role="slider"></div>\n            </div>\n\n            <div :obj="opacity" class="pcr-color-opacity" ${s(e.opacity)}>\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="slider" class="pcr-opacity pcr-slider" tabindex="0" aria-label="${c("aria:opacity")}" role="slider"></div>\n            </div>\n          </div>\n\n          <div class="pcr-swatches ${e.palette?"":"pcr-last"}" :ref="swatches"></div>\n\n          <div :obj="interaction" class="pcr-interaction" ${s(Object.keys(e.interaction).length)}>\n            <input :ref="result" class="pcr-result" type="text" spellcheck="false" ${s(e.interaction.input)} aria-label="${c("aria:input")}">\n\n            <input :arr="options" class="pcr-type" data-type="HEXA" value="${i?"HEX":"HEXA"}" type="button" ${s(e.interaction.hex)}>\n            <input :arr="options" class="pcr-type" data-type="RGBA" value="${i?"RGB":"RGBA"}" type="button" ${s(e.interaction.rgba)}>\n            <input :arr="options" class="pcr-type" data-type="HSLA" value="${i?"HSL":"HSLA"}" type="button" ${s(e.interaction.hsla)}>\n            <input :arr="options" class="pcr-type" data-type="HSVA" value="${i?"HSV":"HSVA"}" type="button" ${s(e.interaction.hsva)}>\n            <input :arr="options" class="pcr-type" data-type="CMYK" value="CMYK" type="button" ${s(e.interaction.cmyk)}>\n\n            <input :ref="save" class="pcr-save" value="${c("btn:save")}" type="button" ${s(e.interaction.save)} aria-label="${c("aria:btn:save")}">\n            <input :ref="cancel" class="pcr-cancel" value="${c("btn:cancel")}" type="button" ${s(e.interaction.cancel)} aria-label="${c("aria:btn:cancel")}">\n            <input :ref="clear" class="pcr-clear" value="${c("btn:clear")}" type="button" ${s(e.interaction.clear)} aria-label="${c("aria:btn:clear")}">\n          </div>\n        </div>\n      </div>\n    `),d=u.interaction;return d.options.find((t=>!t.hidden&&!t.classList.add("active"))),d.type=()=>d.options.find((t=>t.classList.contains("active"))),u})(this),t.useAsButton&&(this._root.button=t.el),t.container.appendChild(this._root.root)}_finalBuild(){const t=this.options,e=this._root;if(t.container.removeChild(e.root),t.inline){const n=t.el.parentElement;t.el.nextSibling?n.insertBefore(e.app,t.el.nextSibling):n.appendChild(e.app)}else t.container.appendChild(e.app);t.useAsButton?t.inline&&t.el.remove():t.el.parentNode.replaceChild(e.root,t.el),t.disabled&&this.disable(),t.comparison||(e.button.style.transition="none",t.useAsButton||(e.preview.lastColor.style.transition="none")),this.hide()}_buildComponents(){const t=this,e=this.options.components,n=(t.options.sliders||"v").repeat(2),[o,a]=n.match(/^[vh]+$/g)?n:[],r=()=>this._color||(this._color=this._lastColor.clone()),i={palette:S({element:t._root.palette.picker,wrapper:t._root.palette.palette,onstop:()=>t._emit("changestop","slider",t),onchange(n,o){if(!e.palette)return;const a=r(),{_root:i,options:s}=t,{lastColor:l,currentColor:c}=i.preview;t._recalc&&(a.s=100*n,a.v=100-100*o,a.v<0&&(a.v=0),t._updateOutput("slider"));const u=a.toRGBA().toString(0);this.element.style.background=u,this.wrapper.style.background=`\n                        linear-gradient(to top, rgba(0, 0, 0, ${a.a}), transparent),\n                        linear-gradient(to left, hsla(${a.h}, 100%, 50%, ${a.a}), rgba(255, 255, 255, ${a.a}))\n                    `,s.comparison?s.useAsButton||t._lastColor||l.style.setProperty("--pcr-color",u):(i.button.style.color=u,i.button.classList.remove("clear"));const d=a.toHEXA().toString();for(const{el:e,color:n}of t._swatchColors)e.classList[d===n.toHEXA().toString()?"add":"remove"]("pcr-active");c.style.setProperty("--pcr-color",u)}}),hue:S({lock:"v"===a?"h":"v",element:t._root.hue.picker,wrapper:t._root.hue.slider,onstop:()=>t._emit("changestop","slider",t),onchange(n){if(!e.hue||!e.palette)return;const o=r();t._recalc&&(o.h=360*n),this.element.style.backgroundColor=`hsl(${o.h}, 100%, 50%)`,i.palette.trigger()}}),opacity:S({lock:"v"===o?"h":"v",element:t._root.opacity.picker,wrapper:t._root.opacity.slider,onstop:()=>t._emit("changestop","slider",t),onchange(n){if(!e.opacity||!e.palette)return;const o=r();t._recalc&&(o.a=Math.round(100*n)/100),this.element.style.background=`rgba(0, 0, 0, ${o.a})`,i.palette.trigger()}}),selectable:E({elements:t._root.interaction.options,className:"active",onchange(e){t._representation=e.target.getAttribute("data-type").toUpperCase(),t._recalc&&t._updateOutput("swatch")}})};this._components=i}_bindEvents(){const{_root:t,options:e}=this,n=[r(t.interaction.clear,"click",(()=>this._clearColor())),r([t.interaction.cancel,t.preview.lastColor],"click",(()=>{this.setHSVA(...(this._lastColor||this._color).toHSVA(),!0),this._emit("cancel")})),r(t.interaction.save,"click",(()=>{!this.applyColor()&&!e.showAlways&&this.hide()})),r(t.interaction.result,["keyup","input"],(t=>{this.setColor(t.target.value,!0)&&!this._initializingActive&&(this._emit("change",this._color,"input",this),this._emit("changestop","input",this)),t.stopImmediatePropagation()})),r(t.interaction.result,["focus","blur"],(t=>{this._recalc="blur"===t.type,this._recalc&&this._updateOutput(null)})),r([t.palette.palette,t.palette.picker,t.hue.slider,t.hue.picker,t.opacity.slider,t.opacity.picker],["mousedown","touchstart"],(()=>this._recalc=!0),{passive:!0})];if(!e.showAlways){const o=e.closeWithKey;n.push(r(t.button,"click",(()=>this.isOpen()?this.hide():this.show())),r(document,"keyup",(t=>this.isOpen()&&(t.key===o||t.code===o)&&this.hide())),r(document,["touchstart","mousedown"],(e=>{this.isOpen()&&!c(e).some((e=>e===t.app||e===t.button))&&this.hide()}),{capture:!0}))}if(e.adjustableNumbers){const e={rgba:[255,255,255,1],hsva:[360,100,100,1],hsla:[360,100,100,1],cmyk:[100,100,100,100]};d(t.interaction.result,((t,n,o)=>{const a=e[this.getColorRepresentation().toLowerCase()];if(a){const e=a[o],r=t+(e>=100?1e3*n:n);return r<=0?0:Number((r<e?r:e).toPrecision(3))}return t}))}if(e.autoReposition&&!e.inline){let t=null;const o=this;n.push(r(window,["scroll","resize"],(()=>{o.isOpen()&&(e.closeOnScroll&&o.hide(),null===t?(t=setTimeout((()=>t=null),100),requestAnimationFrame((function e(){o._rePositioningPicker(),null!==t&&requestAnimationFrame(e)}))):(clearTimeout(t),t=setTimeout((()=>t=null),100)))}),{capture:!0}))}this._eventBindings=n}_rePositioningPicker(){const{options:t}=this;if(!t.inline&&!this._nanopop.update({container:document.body.getBoundingClientRect(),position:t.position})){const t=this._root.app,e=t.getBoundingClientRect();t.style.top=(window.innerHeight-e.height)/2+"px",t.style.left=(window.innerWidth-e.width)/2+"px"}}_updateOutput(t){const{_root:e,_color:n,options:o}=this;if(e.interaction.type()){const t="to"+e.interaction.type().getAttribute("data-type");e.interaction.result.value="function"==typeof n[t]?n[t]().toString(o.outputPrecision):""}!this._initializingActive&&this._recalc&&this._emit("change",n,t,this)}_clearColor(t=!1){const{_root:e,options:n}=this;n.useAsButton||(e.button.style.color="rgba(0, 0, 0, 0.15)"),e.button.classList.add("clear"),n.showAlways||this.hide(),this._lastColor=null,this._initializingActive||t||(this._emit("save",null),this._emit("clear"))}_parseLocalColor(t){const{values:e,type:n,a:o}=A(t),{lockOpacity:a}=this.options,r=void 0!==o&&1!==o;return e&&3===e.length&&(e[3]=void 0),{values:!e||a&&r?null:e,type:n}}_t(t){return this.options.i18n[t]||T.I18N_DEFAULTS[t]}_emit(t,...e){this._eventListener[t].forEach((t=>t(...e,this)))}on(t,e){return this._eventListener[t].push(e),this}off(t,e){const n=this._eventListener[t]||[],o=n.indexOf(e);return~o&&n.splice(o,1),this}addSwatch(t){const{values:e}=this._parseLocalColor(t);if(e){const{_swatchColors:t,_root:n}=this,o=C(...e),a=s(`<button type="button" style="--pcr-color: ${o.toRGBA().toString(0)}" aria-label="${this._t("btn:swatch")}"/>`);return n.swatches.appendChild(a),t.push({el:a,color:o}),this._eventBindings.push(r(a,"click",(()=>{this.setHSVA(...o.toHSVA(),!0),this._emit("swatchselect",o),this._emit("change",o,"swatch",this)}))),!0}return!1}removeSwatch(t){const e=this._swatchColors[t];if(e){const{el:n}=e;return this._root.swatches.removeChild(n),this._swatchColors.splice(t,1),!0}return!1}applyColor(t=!1){const{preview:e,button:n}=this._root,o=this._color.toRGBA().toString(0);return e.lastColor.style.setProperty("--pcr-color",o),this.options.useAsButton||n.style.setProperty("--pcr-color",o),n.classList.remove("clear"),this._lastColor=this._color.clone(),this._initializingActive||t||this._emit("save",this._color),this}destroy(){cancelAnimationFrame(this._setupAnimationFrame),this._eventBindings.forEach((t=>i(...t))),Object.keys(this._components).forEach((t=>this._components[t].destroy()))}destroyAndRemove(){this.destroy();const{root:t,app:e}=this._root;t.parentElement&&t.parentElement.removeChild(t),e.parentElement.removeChild(e),Object.keys(this).forEach((t=>this[t]=null))}hide(){return!!this.isOpen()&&(this._root.app.classList.remove("visible"),this._emit("hide"),!0)}show(){return!this.options.disabled&&!this.isOpen()&&(this._root.app.classList.add("visible"),this._rePositioningPicker(),this._emit("show",this._color),this)}isOpen(){return this._root.app.classList.contains("visible")}setHSVA(t=360,e=0,n=0,o=1,a=!1){const r=this._recalc;if(this._recalc=!1,t<0||t>360||e<0||e>100||n<0||n>100||o<0||o>1)return!1;this._color=C(t,e,n,o);const{hue:i,opacity:s,palette:l}=this._components;return i.update(t/360),s.update(o),l.update(e/100,1-n/100),a||this.applyColor(),r&&this._updateOutput(),this._recalc=r,!0}setColor(t,e=!1){if(null===t)return this._clearColor(e),!0;const{values:n,type:o}=this._parseLocalColor(t);if(n){const t=o.toUpperCase(),{options:a}=this._root.interaction,r=a.find((e=>e.getAttribute("data-type")===t));if(r&&!r.hidden)for(const t of a)t.classList[t===r?"add":"remove"]("active");return!!this.setHSVA(...n,e)&&this.setColorRepresentation(t)}return!1}setColorRepresentation(t){return t=t.toUpperCase(),!!this._root.interaction.options.find((e=>e.getAttribute("data-type").startsWith(t)&&!e.click()))}getColorRepresentation(){return this._representation}getColor(){return this._color}getSelectedColor(){return this._lastColor}getRoot(){return this._root}disable(){return this.hide(),this.options.disabled=!0,this._root.button.classList.add("disabled"),this}enable(){return this.options.disabled=!1,this._root.button.classList.remove("disabled"),this}}D(T,"utils",o),D(T,"version","1.8.1"),D(T,"I18N_DEFAULTS",{"ui:dialog":"color picker dialog","btn:toggle":"toggle color picker dialog","btn:swatch":"color swatch","btn:last-color":"use previous color","btn:save":"Save","btn:cancel":"Cancel","btn:clear":"Clear","aria:btn:save":"save and close","aria:btn:cancel":"cancel and close","aria:btn:clear":"clear and close","aria:input":"color input field","aria:palette":"color selection area","aria:hue":"hue selection slider","aria:opacity":"selection slider"}),D(T,"DEFAULT_OPTIONS",{appClass:null,theme:"classic",useAsButton:!1,padding:8,disabled:!1,comparison:!0,closeOnScroll:!1,outputPrecision:0,lockOpacity:!1,autoReposition:!0,container:"body",components:{interaction:{}},i18n:{},swatches:null,inline:!1,sliders:null,default:"#42445a",defaultRepresentation:null,position:"bottom-middle",adjustableNumbers:!0,showAlways:!1,closeWithKey:"Escape"}),D(T,"create",(t=>new T(t))),e.default=T}]).default}}]);
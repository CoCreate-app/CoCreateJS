(this.webpackChunkCoCreate=this.webpackChunkCoCreate||[]).push([[3238],{15636:function(t,e,n){var a,i;"undefined"!=typeof self&&self,a=[n(15452),n(96406)],void 0===(i=function(t,e){return function(t,e,n){return{socket:null,setSocket:function(t){this.socket=t},readDocumentList(t){if(!t)return;let n=e.getCommonParams();t.collection&&t.operator&&(n={...n,...t},this.socket.send("readDocumentList",n))},createDocument:function(n){if(null===n)return;let a=e.getCommonParamsExtend(n),i={...n,...a},r=n.data||{};r.organization_id||(r.organization_id=t.config.organization_Id),n.data&&(r={...r,...n.data}),i.data=r;const o=e.generateSocketClient(n.namespace,n.room);this.socket.send("createDocument",i,o)},updateDocument:function(t){if(!t||!n.checkDocumentId(t.document_id))return;let a=e.getCommonParamsExtend(t),i={...t,...a};if("object"==typeof t.data&&(i.set=t.data),Array.isArray(t.delete_fields)&&(i.unset=t.delete_fields),!i.set&&!i.unset)return;!1===t.broadcast&&(i.broadcast=!1),void 0===t.broadcast_sender&&(i.broadcast_sender=!0);const r=e.generateSocketClient(t.namespace,t.room);this.socket.send("updateDocument",i,r)},readDocument:function(t){if(null===t)return;if(!t||!n.checkDocumentId(t.document_id))return;let a=e.getCommonParamsExtend(t),i={...t,...a};this.socket.send("readDocument",i)},deleteDocument:function(t){if(!t||!n.checkDocumentId(t.document_id))return;let a=e.getCommonParamsExtend(t),i={...t,...a};const r=e.generateSocketClient(t.namespace,t.room);this.socket.send("deleteDocument",i,r)},exportCollection:function(t){if(null===t)return;let n=e.getCommonParamsExtend(t);n.collection=t.collection,n.export_type=t.export_type,n.metadata=t.metadata,this.socket.send("exportDB",n)},importCollection:function(n){const{file:a}=n;if(null===n||!(a instanceof t.File))return;const i=a.name.split(".").pop();if(!["json","csv"].some((t=>t===i)))return;let r=e.getCommonParamsExtend(n);r.collection=n.collection,r.import_type=i,this.socket.send("importDB",r),this.socket.sendFile(a)},listen:function(t,e){this.socket.listen(t,e)},listenAsync:function(t){return this.socket.listenAsync(t)},createSocket:function(t,e){e?(this.socket.create({namespace:e,room:null,host:t}),this.socket.setGlobalScope(e)):this.socket.create({namespace:null,room:null,host:t})},...n}}(window,t,e)}.apply(e,a))||(t.exports=i)},72612:function(t,e,n){var a,i;"undefined"!=typeof self&&self,a=[n(64716),n(15636)],void 0===(i=function(t,e){return function(t,e,n){if(t){let t=new e("ws");n.setSocket(t),n.createSocket(window.config.host?window.config.host:window.location.hostname,window.config.organization_Id)}return n}(!0,t,e)}.apply(e,a))||(t.exports=i)},96406:function(t,e){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(){function t(e,n){e=e||{};for(let a of Object.keys(n))n[a]instanceof Object&&Object.assign(n[a],t(e[a],n[a]));return Object.assign(e||{},n),e}function e(t,e){if(!e)return t;let n=e.split("."),a=t;for(var i=n.length-1;i>=0;i--)a={[n[i]]:a};return a}function n(t,e){try{let n=/([\w\W]+)\[(\d+)\]/gm.exec(t);if(n&&3==n.length){let a=n[1],i=parseInt(n[2]);e[a]&&Array.isArray(e[a])||(e[a]=[]),e[a][i]=e[t],delete e[t],t=a}}catch{}return t}function a(t){return!!t&&t.constructor===Object}function i(t){return!!t&&t.constructor===Array}function r(a){let i=Object.keys(a),r={};return i.forEach((i=>{if((i=n(i,a)).split(".").length>1){let n=e(a[i],i);delete a[i],r=t(r,n)}else r[i]=a[i]})),r}function o(t){let e=Object.keys(t),n={};return e.forEach((e=>{let r=t[e];if(a(t[e])){let a=o(t[e]);Object.keys(a).forEach((t=>{let i=a[t];n[t=e+"."+t]=i}))}else i(r)?r.forEach(((t,a)=>{n[`${e}[${a}]`]=t})):n[e]=t[e]})),n}function s(t){if(t)return{collection:t.getAttribute("data-collection"),document_id:t.getAttribute("data-document_id"),name:t.getAttribute("name")}}function l(t){return t?{is_realtime:f(t),is_save:u(t),is_read:c(t),is_update:d(t)}:{}}const c=t=>m(t,"data-read_value"),u=t=>m(t,"data-save_value"),d=t=>m(t,"data-update_value"),f=t=>!!t&&"false"!=t.getAttribute("data-realtime");function m(t,e){return!!t&&"false"!==t.getAttribute(e)}function h(t){return!!t&&!/{{\s*([\w\W]+)\s*}}/g.test(t)}function _(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e}catch(t){return!1}}function g(t){const{collection:e,document_id:n,name:a}=s(t);return!(_(e)||_(a)||!("INPUT"===t.tagName&&["text","email","tel","url"].includes(t.type)||"TEXTAREA"===t.tagName)||!a||!f(t)||"true"===t.getAttribute("data-unique")||"password"===t.type||!c(t))}function p(t){try{return!!t&&"null"!==t.toLowerCase()}catch(t){return!1}}return{decodeObject:r,encodeObject:o,getAttr:s,getFlagAttr:l,isRealtimeAttr:f,isReadAttr:c,isSaveAttr:u,isUpdateAttr:d,checkValue:h,isCRDT:g,checkDocumentId:p}}()}.apply(e,[]))||(t.exports=n)},84600:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>o});n(31159);var a=n(72612),i=n.n(a);const r={items:[],ioInstance:null,moduleAttribues:[],module_items:[],__init:function(){this.__initIntesection(),this.__initSocket(),this.__initEvents()},__initIntesection:function(){const t=this;this.ioInstance=new IntersectionObserver(((e,n)=>{e.forEach((e=>{if(e.isIntersecting){const n=t.__getMainAttribue(e.target);n.id&&document.dispatchEvent(new CustomEvent("CoCreateFilter-loadMore",{detail:{attrName:n.name,attrId:n.id}})),t.ioInstance.unobserve(e.target)}}))}),{threshold:1})},__runLoadMore:function(t,e){if(!e||!t)return;let n=this.items.find((n=>n.attrName===t&&n.id===e));n&&n.count>0&&this.fetchData(n)},__getMainAttribue:function(t){const e=this.moduleAttribues.find((e=>""!==(t.getAttribute(e)||"")));return e?{name:e,id:t.getAttribute(e)}:{}},__initSocket:function(){const t=this;i().listen("readDocumentList",(function(e){let n=e.element,a=t.items.find((t=>t.id===n));if(a){const n=e.data;let i=document.querySelector(`[${a.attrName}="${a.id}"][data-fetch_type="scroll"]`);n.length>0&&i&&t.ioInstance.observe(i);const r=e.operator.total,o=document.querySelectorAll(`[${a.attrName}="${a.id}"][data-fetch_type="total"]`);o&&o.forEach((t=>t.innerHTML=r))}}))},__initEvents:function(){const t=this;document.addEventListener("CoCreateFilter-loadMore",(function(e){const n=e.detail.attrId,a=e.detail.attrName;t.__runLoadMore(a,n)})),document.querySelectorAll('[data-fetch_type="loadmore"]').forEach((e=>{e.addEventListener("click",(function(n){n.preventDefault();const a=t.__getMainAttribue(e);a.id&&t.__runLoadMore(a.attrName,a.attrId)}))}))},setFilter:function(t,e,n){if(!e)return;let a=t.getAttribute(e);if(!a)return;this.moduleAttribues.includes(e)||this.moduleAttribues.push(e);let i=t.getAttribute("data-fetch_collection"),r="collection"==t.getAttribute("data-fetch_value_type"),o=t.getAttribute("data-order_by"),s=t.getAttribute("data-order_type")||"asc",l=parseInt(t.getAttribute("data-fetch_count")),c={el:t,id:a,eId:a,type:n,attrName:e,collection:i,startIndex:0,options:{},fetch:{},is_collection:r,search:{type:"or",value:[]},orders:[],filters:[]};return!isNaN(l)&&l>0&&(c.count=l),o&&c.orders.push({name:o,type:"asc"==s?1:-1}),this._initFilter(c,a,e),this._initOrder(c,a,e),this.items.push(c),this._initInputForm(c,e),this._initExportImport(c,a,e),c},_initFilter:function(t,e,n){let a=t.el.getRootNode().querySelectorAll("["+n+'="'+e+'"]');for(var i=0;i<a.length;i++){let r=a[i],o=r.getAttribute("data-filter_name"),s=r.getAttribute("data-filter_operator")?r.getAttribute("data-filter_operator"):"$contain",l=r.getAttribute("data-filter_value_type")?r.getAttribute("data-filter_value_type"):"string",c=r.getAttribute("data-filter_type"),u=r.getAttribute("data-filter_value");if(null!=u)if("raw"!==l&&(u=u.replace(/\s/g,"").split(",")),o){let e=this.getFilterByName(t,o,s);if("string"!=l)for(let t=0;t<u.length;t++)u[t]=Number(u[t]);this.insertArrayObject(t.filters,e,{name:o,value:u,operator:s,type:c})}else t.search.value=this._makeSearchOption(e,n)}},_initOrder:function(t,e,n){let a=t.el.getRootNode().querySelectorAll("["+n+'="'+e+'"]');const i=this;for(var r=0;r<a.length;r++){let e=a[r],n=e.getAttribute("data-order_by"),o=e.getAttribute("value");n&&o&&(["A","BUTTON"].includes(e.tagName)?e.addEventListener("click",(function(){let e=this.getAttribute("data-order_by"),n=this.getAttribute("value");i._applyOrder(t,e,n),t.el&&t.el.dispatchEvent(new CustomEvent("changeFilterInput",{detail:{type:"order"}}))})):this._applyOrder(t,n,o))}this._initToggleOrderEvent(t,e,n)},_initToggleOrderEvent:function(t,e,n){let a=document.querySelectorAll(`[${n}="${e}"][data-toggle_order]`);const i=this;a.forEach((e=>{e.addEventListener("click",(function(){let n=this.getAttribute("data-toggle_order")||"",r=this.getAttribute("data-order_by");n="asc"===n?"desc":"asc";for(let t=0;t<a.length;t++)a[t]!==e&&a[t].setAttribute("data-toggle_order","");t.orders=[],i._applyOrder(t,r,n),e.setAttribute("data-toggle_order",n),t.el&&t.el.dispatchEvent(new CustomEvent("changeFilterInput",{detail:{type:"order"}}))}))}))},_initExportImport:function(t,e,n){let a=document.querySelector(`[data-export_type][${n}="${e}"]`),r=document.querySelector(`[data-import="true"][${n}="${e}"]`);const o=this;a&&a.addEventListener("click",(function(){if(!t)return;let e=o.makeFetchOptions(t);e.export={collection:e.collection,type:a.getAttribute("data-export_type")||"json"},i().readDocumentList(e)})),r&&r.addEventListener("click",(function(){var e=document.createElement("input");if(e.type="file",!t)return;let n=t.collection;e.onchange=t=>{var e=t.target.files[0];i().importCollection({collection:n,file:e})},e.click()}))},_applyOrder:function(t,e,n){if(!n)return;let a=0,i=this.getOrderByName(t,e);a="asc"==n?1:"desc"==n?-1:[],this.insertArrayObject(t.orders,i,{name:e,type:a},a)},changeCollection:function(t){let e=t.el.getAttribute("data-fetch_collection");t.collection=e,t.startIndex=0},_makeSearchOption:function(t,e){let n=document.querySelectorAll("form["+e+"="+t+"]"),a="["+e+"="+t+"]",i=document.querySelectorAll("input"+a+",textarea"+a+", select"+a),r=[];for(let t=0;t<n.length;t++){let e=n[t].querySelectorAll("input, textarea, select");e=Array.prototype.slice.call(e),r=r.concat(e)}i=Array.prototype.slice.call(i),r=r.concat(i);let o=[];for(var s=0;s<r.length;s++){let t=r[s].getAttribute("data-filter_name"),e=r[s].getAttribute("data-order_by"),n=r[s],a=n.getAttribute("data-value_type")?n.getAttribute("data-value_type"):"string",i=null;t||e||("checkbox"!=n.type||n.checked?(i=n.value,"string"!=a&&(i=Number(i)),i&&!o.includes(i)&&o.push(i)):i=null)}return o},_initInputForm:function(t,e){if(!t)return;let n="["+e+'="'+t.id+'"]',a=t.el.getRootNode().querySelectorAll("form"+n+" input, form"+n+" textarea, form"+n+" select"),i=t.el.getRootNode().querySelectorAll("input"+n+",textarea"+n+", select"+n);this.setCheckboxName(t.id,e),a=Array.prototype.slice.call(a),i=Array.prototype.slice.call(i),a=a.concat(i);for(let e=0;e<a.length;e++){let n=a[e];n.getAttribute("data-order_by")?this._initOrderInput(t,n):this._initFilterInput(t,n,t.id)}},_initOrderInput:function(t,e){var n=this;e.addEventListener("change",(function(e){e.preventDefault();let a=this.getAttribute("data-order_by"),i=0,r=n.getOrderByName(t,a);i="asc"==this.value?1:"desc"==this.value?-1:[],n.insertArrayObject(t.orders,r,{name:a,type:i},i),t.el&&t.el.dispatchEvent(new CustomEvent("changeFilterInput",{detail:{type:"order"}}))}))},_initFilterInput:function(t,e,n){var a,i=this;e.addEventListener("input",(function(r){r.preventDefault();let o=this.getAttribute("data-filter_name"),s=this.getAttribute("data-filter_operator")||"$contain",l=this.getAttribute("data-filter_type"),c=this.getAttribute("data-filter_value_type")||"string";clearTimeout(a),a=setTimeout((function(){if(o){let n=i.getFilterByName(t,o,s),d=e.type,f=[];if("checkbox"==d)for(var a=document.querySelectorAll("input[name="+e.name+"]:checked"),r=0;r<a.length;r++)f.push(a[r].value);else if("raido"==d);else if("range"==d)f=[Number(e.min),Number(e.value)];else{var u=e.value;"string"!=c&&(u=Number(u)),"none"!=u&&(f=[u]),"raw"===c&&(f=u)}i.insertArrayObject(t.filters,n,{name:o,value:f,operator:s,type:l})}else t.search.value=i._makeSearchOption(n,t.attrName);t.el&&t.el.dispatchEvent(new CustomEvent("changeFilterInput",{detail:{type:"filter"}}))}),500)}))},setCheckboxName:function(t,e){for(var n=document.querySelectorAll("form["+e+'="'+t+'"]'),a=0;a<n.length;a++)for(var i=n[a].querySelectorAll("input[type=checkbox], form input[type=radio]"),r=0;r<i.length;r++){var o=i[r].getAttribute("name"),s=i[r].getAttribute("data-filter_name");!o&&s&&i[r].setAttribute("name","_"+t+"-"+s+"_"+a)}},getFilterByName:function(t,e,n){for(var a=0;a<t.filters.length;a++){var i=t.filters[a];if(i.name==e&&i.operator==n)return a}return-1},insertArrayObject:function(t,e,n,a){return a||(a=n.value),"object"==typeof a&&0==a.length?-1!=e&&t.splice(e,1):-1!=e?t[e]=n:t.push(n),t},getOrderByName:function(t,e){for(var n=0;n<t.orders.length;n++)if(t.orders[n].name==e)return n;return-1},defineEvent:function(t){t.el.addEventListener("fetchFilterData",(function(t){}))},fetchData:function(t){let e=this.makeFetchOptions(t);i().readDocumentList(e)},getObjectByFilterId:function(t,e){for(var n=0;n<t.length;n++){let a=t[n].filter;if(a&&a.id==e)return t[n]}},getObjectByElement:function(t,e){for(var n=0;n<t.length;n++){let a=t[n].filter;if(a&&a.el.isSameNode(e))return t[n]}},makeFetchOptions:function(t){let e={collection:t.collection,element:t.eId,metadata:{isRefresh:t.isRefresh},operator:{filters:t.filters,orders:t.orders,search:t.search,startIndex:t.startIndex},is_collection:t.is_collection};return t.count&&(e.operator.count=t.count),e},init:function({name:t,attribute:e,callback:n}){let a=document.querySelectorAll(`[data-fetch_collection][${e}]`);const r=this;a.forEach((n=>{r.__initFilterElement(n,e,t)})),i().listen("readDocumentList",(function(t){n.call(null,t)}))},__initFilterElement:function(t,e,n){let a=t.getAttribute(e);const i=this;if(!a)return;let r=this.setFilter(t,e,n);r&&(this.module_items.push({el:t,filter:r,id:a,name:n}),t.addEventListener("changeFilterInput",(function(t){i.fetchData(r)})),this.fetchData(r))}};r.__init();const o=r},67924:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var a=n(97636);const i={attribute:"data-actions",actions:{},selectedStage:[],stageIndex:0,selectedElement:null,completedEventName:"completedEvent",__init:function(){this.actionButtonEvent()},actionButtonEvent:function(){const t=this;document.addEventListener("click",(function(e){let n=e.target;if(n.getAttribute("data-actions")||(n=e.target.closest("[data-actions]")),!n)return;e.preventDefault();let a=(n.getAttribute(t.attribute)||"").replace(/\s/g,"").split(",");0!=a.length&&(t.stageIndex=0,t.selectedStage=a,t.selectedElement=n,t.__runActionFunc())}))},init:function({action:t,callback:e,endEvent:n}){this.registerEvent(t,e,null,n)},registerEvent:function(t,e,n,a){if(this.actions[t])return;this.actions[t]={key:t,runFunc:e,instance:n||window,endEvent:a};for(let e in this.actions)if(e!=t&&this.actions[e].endEvent===a)return;const i=this;document.addEventListener(a,(function(t){i.__nextAction(a,t.detail)}))},__runActionFunc:function(t){if(this.stageIndex>=this.selectedStage.length)return void(this.stageIndex==this.selectedStage.length&&this.__runAtag(this.selectedElement));const e=this.selectedStage[this.stageIndex],n=this.actions[e];if(n)n.runFunc?n.runFunc.call(null,this.selectedElement,t):this.__nextAction(n.endEvent,{});else{"next"===this.__runSpecialAction(e,t)&&this.__moveNextAction()}},__nextAction:function(t,e){const n=this.selectedStage[this.stageIndex];n&&t===this.actions[n].endEvent&&this.__moveNextAction(e)},__runAtag:function(t){t.querySelector("a")},__runSpecialAction:function(t,e){let n=/(\w+)\{([a-zA-Z0-9_ \-#$.]+)\}/gm.exec(t);if(!n||n.length<3)return"next";let a=n[1],i=n[2].trim();if(!i)return"next";const r=this;switch(a){case"event":document.addEventListener(i,(t=>{r.__moveNextAction(t)}),{once:!0});break;case"timeout":parseInt(i)>0&&setTimeout((function(){r.__moveNextAction(e)}),parseInt(i));break;case"action":let t=document.querySelector(i);t&&t.click();break;default:return"next"}},__moveNextAction:function(t){this.stageIndex++,this.__runActionFunc(t)}};i.__init();const r=i;n(31159);var o=n(72612),s=n.n(o);const l={mainInfo:{},init:function(){const t=this;s().listen("updateDocument",(function(e){t.render(e)})),s().listen("readDocument",(function(e){t.render(e)})),s().listen("connect",(function(e){t.__getRequest()}))},initElement:function(t){const e=this.__getRequest(t);e&&e.forEach((t=>{s().readDocument({collection:t.collection,document_id:t.document_id})}))},render:function(t){const e=t.collection,n=t.document_id;for(let a in t.data){const i=this.__makeKey(e,n,a),r=t.data[a];this.mainInfo[i]&&this.mainInfo[i].forEach((t=>{t.el.setAttribute(t.attr,r),t.el.dispatchEvent(new CustomEvent("CoCreateAttribute-run",{eventType:"rendered",item:t.el}))}))}},setValue:function(t,e){},__getRequest:function(t){let e=t||document,n=e.querySelectorAll("[fetch-for]"),a=this,i=[];return 0===n.length&&e!=document&&e.hasAttributes("fetch-for")&&(n=[e]),n.forEach((t=>{const e=t.getAttribute("data-collection"),n=t.getAttribute("data-document_id"),r=t.getAttribute("name"),o=t.getAttribute("value"),s=t.attributes;for(let l=0;l<s.length;l++){let c=a.__jsonParse(s[l].value);if(c){let u=c.collection||e,d=c.document_id||n,f=c.name||r,m=c.value||o;if(c["data-pass_id"]){let t=a.__checkPassId(c["data-pass_id"]);t?(u=t.collection,d=t.document_id,m=t.value):(u=null,d=null,m=null)}const h=a.__makeKey(u,d,f);u&&d&&f&&(a.mainInfo[h]||(a.mainInfo[h]=[]),a.mainInfo[h].push({el:t,attr:s[l].name}),i.some((t=>t.collection===u&&t.document_id===d))||i.push({collection:u,document_id:d}))}}})),i},__jsonParse:function(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e?e:null}catch(t){return null}},__checkPassId:function(t){var e=localStorage.getItem("dataParams");if(!(e=JSON.parse(e))||0==e.length)return null;for(var n=0;n<e.length;n++)if(e[n].pass_to==t)return{collection:e[n].collection,document_id:e[n].document_id,value:e[n].value};return null},__makeKey:function(t,e,n){return`${t}_${e}_${n}`}};l.init(),a.default.init({name:"CoCreateAttributes",observe:["subtree","childList"],include:"[data-for]",callback:function(t){l.initElement(t.target)}});const c={attributes:l,init:function(){this.__initKeys(),this.__initPassSessionIds(),this.__initPassParams(),this.__initPassValueParams(),this.__initGetValueInput(),this.initAtagElement()},__initKeys:function(){window.localStorage.getItem("apiKey")&&(config.apiKey=window.localStorage.getItem("apiKey")),window.localStorage.getItem("securityKey")&&(config.securityKey=window.localStorage.getItem("securityKey")),window.localStorage.getItem("organization_id")&&(config.organization_Id=window.localStorage.getItem("organization_id"))},__initPassSessionIds:function(){let t=window.localStorage.getItem("organization_id"),e=window.localStorage.getItem("user_id"),n=window.localStorage.getItem("adminUI_id"),a=window.localStorage.getItem("builderUI_id");this.__initPassItems(t,".sessionOrg_Id",!0),this.__initPassItems(e,".sessionUser_Id"),this.__initPassItems(n,".sessionAdminUI_Id"),this.__initPassItems(a,".sessionBuilderUI_Id")},initElement:function(t){const e=this;let n=t||document;if(!n.querySelectorAll)return;let i=n.querySelectorAll("[data-pass_id]");i=Array.from(i),n!=document&&n.hasAttribute("data-pass_id")&&i.push(n);let r=window.localStorage.getItem("dataParams");r=JSON.parse(r),r&&0!=r.length&&i.forEach((t=>{if(a.default.getInitialized(t))return;const n=t.getAttribute("data-pass_id"),i=r.find((t=>t.pass_to==n));if(!i)return;const{collection:o,document_id:s,pass_to:l,prefix:c}=i;a.default.setInitialized(t),"FORM"===t.tagName&&!t.getAttribute("data-colleciton")&&o&&t.setAttribute("data-colleciton",o),e.__setPassAttributes(t,i)}))},initAtagElement:function(){const t=this;document.addEventListener("click",(function(e){const n=e.target.closest("a, button");if(!n)return;if("modal"===n.getAttribute("target")&&n.getAttribute("data-pass_to"))return e.preventDefault(),void t.setLinkProcess(n);const a=n.getAttribute("href");if("modal"!==n.getAttribute("target")){if(n.hasAttribute("data-actions"))return;if(!t.passSubmitProcess(n))return;const i=n.getAttribute("data-pass_to");a?(e.preventDefault(),t.storePassData(n),t.openAnother(n)):(t.storePassData(n),i&&t.__initPassParams(i))}}))},__initPassParams:function(t){var e=window.localStorage.getItem("dataParams");if(!(e=JSON.parse(e))||0==e.length)return;let n=this;e.forEach((function(e){var a=e.collection,i=(e.document_id,e.prefix,e.pass_to);t&&i!=t||(document.querySelectorAll("form").forEach((t=>{var e=t.getAttribute("data-pass_id");e&&e==i&&a&&""!=a&&(t.getAttribute("data-collection")||t.setAttribute("data-collection",a))})),document.querySelectorAll("[data-pass_id]").forEach((t=>{var a=t.getAttribute("data-pass_id");a&&a==i&&n.__setPassAttributes(t,e)})))}))},__initPassValueParams:function(t){var e=window.localStorage.getItem("valueParams");(e=JSON.parse(e))&&0!=e.length&&e.forEach((function(e){var n=e.pass_value_to;(t||document).querySelectorAll("[data-pass_value_id]").forEach((t=>{let a=t.getAttribute("data-pass_value_id");a&&a==n&&(["INPUT","TEXTAREA","SELECT"].includes(t.tagName)?(t.value=e.value,CoCreate.floatingLabel&&CoCreate.floatingLabel.update(t)):t.innerHTML=e.value)}))}))},__getPassAttributes:function(t){return{collection:t.getAttribute("data-pass_collection")||t.getAttribute("data-pass_fetch_collection"),document_id:t.getAttribute("data-pass_document_id"),name:t.getAttribute("data-pass_name"),value:t.getAttribute("data-pass_value"),pass_to:t.getAttribute("data-pass_to"),filter_name:t.getAttribute("data-pass_filter_name"),filter_value:t.getAttribute("data-pass_filter_value"),prefix:t.getAttribute("data-pass_prefix")||""}},__setPassAttributes:function(t,e){const{collection:n,document_id:a,name:i,value:r,pass_to:o,filter_name:s,filter_value:l,prefix:c}=e,u=t.getAttribute("data-pass_id"),d=!!t.hasAttribute("data-pass_refresh");u==o&&(n&&(this.__setAttributeValueOfElement(t,"data-collection",n,d),this.__setAttributeValueOfElement(t,"data-fetch_collection",n,d),this.__setAttributeValueOfElement(t,"data-pass_fetch_collection",n,d),this.__setAttributeValueOfElement(t,"data-pass_collection",n,d)),a&&(this.__setAttributeValueOfElement(t,"data-document_id",a,d),this.__setAttributeValueOfElement(t,"data-fetch_document_id",a,d),this.__setAttributeValueOfElement(t,"data-pass_fetch_document_id",a,d),this.__setAttributeValueOfElement(t,"data-pass_document_id",a,d)),i&&(this.__setAttributeValueOfElement(t,"name",i,d),this.__setAttributeValueOfElement(t,"data-fetch_name",i,d),this.__setAttributeValueOfElement(t,"data-pass_name",i,d)),r&&(this.__setAttributeValueOfElement(t,"value",r,d),this.__setAttributeValueOfElement(t,"data-pass_value",r,d)),c&&(this.__setAttributeValueOfElement(t,"name",c+t.getAttribute("name"),d,!0),this.__setAttributeValueOfElement(t,"data-fetch_name",c+t.getAttribute("data-fetch_name"),d,!0),this.__setAttributeValueOfElement(t,"data-pass_prefix",c,d)),s&&(this.__setAttributeValueOfElement(t,"data-filter_name",s,d),this.__setAttributeValueOfElement(t,"data-pass_filter_name",s,d)),l&&(this.__setAttributeValueOfElement(t,"data-filter_value",l,d),this.__setAttributeValueOfElement(t,"data-pass_filter_value",l,d)))},__setAttributeValueOfElement:function(t,e,n,a,i){if(n){if(t.hasAttribute(e)&&i)return void t.setAttribute(e,n);if(t.hasAttribute(e)&&(!t.getAttribute(e)||a))return void t.setAttribute(e,n)}},storePassData:function(t){let e=[];const n=this;let a=this.__getPassAttributes(t);t.hasAttribute("data-actions")||(a.pass_to&&e.push(a),t.querySelectorAll("[data-pass_to]").forEach((t=>{let a=n.__getPassAttributes(t);a.pass_to&&e.push(a)})),e.length>0&&localStorage.setItem("dataParams",JSON.stringify(e)))},__initValuePassBtns:function(){},__initGetValueInput:function(){var t=document.querySelectorAll("input, textarea");let e=this;for(var n=0;n<t.length;n++){var a=t[n];a.id&&(a.addEventListener("input",(function(t){e.__setGetValueProcess(this.id,this.value)})),a.addEventListener("updated_by_fetch",(function(t){e.__setGetValueProcess(this.id,this.value)})))}},__registerValuePassBtnEvent:function(t,e){},passProcessAction:function(t){let e=t.closest("form");if(!e)return;let n=e.querySelectorAll("input, textarea, select"),a=[];n.forEach((t=>{const e=t.getAttribute("data-pass_value_to"),n=t.value;e&&a.push({pass_value_to:e,value:n})})),a.length>0&&window.localStorage.setItem("valueParams",JSON.stringify(a)),this.__initPassValueParams(),document.dispatchEvent(new CustomEvent("passValueActionEnd",{detail:{}}))},setDataPassValues:function(t){const e=[];for(let n in t)e.push({pass_value_to:n,value:t[n]});e.length>0&&window.localStorage.setItem("valueParams",JSON.stringify(e))},initDataPassValues:function(){window.localStorage.removeItem("valueParams")},openAnother:function(t){var e=t.getAttribute("href"),n=t.getAttribute("target");"_blank"==n?window.open(e,"_blank"):"_window"==n?window.open(e,"_blank","location=yes,height=570,width=520,scrollbars=yes,status=yes"):window.open(e,"_self")},setLinkProcess:function(t){if(t.hasAttribute("data-actions"))return;const e=t.getAttribute("data-pass_to"),n=t.getAttribute("href");this.storePassData(t),this.checkOpenCocreateModal(t)?void 0!==CoCreate.modal&&CoCreate.modal.open(t):n?this.openAnother(t):e&&this.__initPassParams(e)},checkOpenCocreateModal:function(t){return"modal"===t.getAttribute("target")},passSubmitProcess:function(t){return!t.parentNode.classList.contains("submitBtn")||!(!t.getAttribute("data-pass_to")||!t.getAttribute("data-pass_document_id"))},__setGetValueProcess:function(t,e){t&&document.querySelectorAll('[data-get_value="'+t+'"]').forEach((t=>{if(void 0!==t.value?t.value=e:void 0!==t.textContent&&(t.textContent=e),CoCreate.floatingLabel&&CoCreate.floatingLabel.update(t),t.dispatchEvent(new Event("input",{bubbles:!0})),t.classList.contains("searchInput")){let e=new KeyboardEvent("keydown",{keyCode:13});t.dispatchEvent(e)}}))},__initPassItems:function(t,e,n){const a=this;if(t){document.querySelectorAll(e).forEach((e=>{a.__setAttributeValueOfElement(e,"data-document_id",t),a.__setAttributeValueOfElement(e,"data-filter_value",t)}))}}};c.init(),a.default.init({name:"CoCreateAttributes",observe:["subtree","childList"],include:"[data-for]",callback:function(t){c.attributes.initElement(t.target)}}),a.default.init({name:"CoCreateLogic",observe:["subtree","childList"],include:"[data-pass_id]",callback:function(t){c.initElement(t.target)}}),r.init({action:"passValueAction",endEvent:"passValueActionEnd",callback:(t,e)=>{c.passProcessAction(t)}});const u=c},97636:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i}),window.profiler={},window.counter=0,window.counter2=0,window.targets={},window.attributeName={},Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;--n>=0&&e.item(n)!==this;);return n>-1});const a={initTasks:new Map,attrTasks:new Map,rules:new Map,rulesArray:[],__init:function(){const t=this;new MutationObserver(((e,n)=>t.__callback(e,n))).observe(document.body,{attributes:!0,childList:!0,subtree:!0,characterData:!1,attributeOldValue:!0,characterData:!0})},init:function({observe:t,include:e,exclude:n,attributes:a,name:i,callback:r}){t.some((t=>"childList"==t))&&this.initTasks.set(r,{observe:t,include:e,exclude:n,attributes:a,name:i}),t.some((t=>"attributes"==t))&&this.attrTasks.set(r,{observe:t,include:e,exclude:n,attributes:a,name:i})},remove:function(t){this.initTasks.delete(t),this.attrTasks.delete(t)},addRule:function({include:t,exclude:e,name:n}){this.rules.set(n,{include:t,exclude:e}),this.rulesArray=Array.from(this.rules)},removeRule:function({name:t}){this.rules.delete(t),this.rulesArray=Array.from(this.rules)},__callback:function(t,e){window.counter++;for(let e of t)"childList"==e.type&&e.addedNodes.length>0&&this.__initCallback(e),"attributes"==e.type&&this.__attrCallback(e)},__initCallback:function(t){Array.from(t.addedNodes);this.initTasks.forEach((({observe:e,include:n,exclude:a,attributes:i,name:r},o)=>{t.addedNodes.forEach((e=>{e.tagName&&(!n||e.matches(n)||e.querySelector(n))&&(a&&(e.matches(a)||e.querySelector(a))||o.apply(null,[{type:t.type,target:e}]))}))}))},__attrCallback:function(t){for(let[e,{include:n,exclude:a}]of this.rulesArray){if(n&&!t.target.matches(n))return;if(a&&t.target.matches(a))return}this.attrTasks.forEach((({observe:e,include:n,exclude:a,attributes:i,name:r},o)=>{if((!i||!t.attributeName||i.includes(t.attributeName))&&(!n||t.target.matches(n))&&(!a||!t.target.matches(a))&&t.attributeName){t.target.getAttribute(t.attributeName)!=t.oldValue&&o.apply(null,[t])}}))},setInitialized:function(t,e){t["co_initialized_"+(e=e||"")]=!0},getInitialized:function(t,e){return!!t["co_initialized_"+(e=e||"")]}};a.__init();const i=a},3852:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>a});const a={__getValueFromObject:function(t,e){try{if(void 0===t||!e)return!1;let n=t,a=e.split(".");for(let t=0;t<a.length;t++)if(n=n[a[t]],!n)return!1;return n}catch(t){return!1}},__getValue:function(t,e){let n=/{{\s*([\w\W]+)\s*}}/g.exec(e);return!!n&&this.__getValueFromObject(t,n[1].trim())},__createObject:function(t,e){try{if(!e)return t;let a=e.split("."),i=t;for(var n=a.length-1;n>=0;n--)i={[a[n]]:i};return i}catch(t){return!1}},__replaceValue:function(t,e){let n=!1,a=this,i=null,r=e.match(/{{([A-Za-z0-9_.,\- ]*)}}/g);return r&&(r.forEach((i=>{let r=a.__getValue(t,i);r&&"object"!=typeof r&&(n=!0,e=e.replace(i,r))})),n&&(i=e)),i},setArray:function(t,e){const n=t.getAttribute("data-render_array")||"data",a=t.getAttribute("data-render_key")||n,i=this,r=this.__getValueFromObject(e,n);n&&Array.isArray(r)&&r.forEach(((e,r)=>{let o=t.cloneNode(!0);o.classList.remove("template"),o.classList.add("clone_"+n),"object"!=typeof e?e={"--":e}:e.index=r;let s=i.__createObject(e,a);i.setValue([o],s),t.insertAdjacentHTML("beforebegin",o.outerHTML)}))},setValue:function(t,e,n,a){if(!e)return;const i=this;Array.from(t).forEach((t=>{let a=t.getAttribute("data-pass_id");if(!n||a==n){if(Array.from(t.attributes).forEach((n=>{let a=n.name.toLowerCase(),r=n.value;if(r=i.__replaceValue(e,r),r){if("value"==a){switch(t.tagName.toLowerCase()){case"input":t.setAttribute(a,r);break;case"textarea":t.setAttribute(a,r),t.textContent=r;break;default:0===t.children.length&&(t.innerHTML=r)}}t.setAttribute(a,r)}})),0==t.children.length&&t.textContent){let n=t.textContent;n=i.__replaceValue(e,n),n&&(t.textContent=n)}t.children.length>0&&(i.setValue(t.children,e),t.classList.contains("template")&&i.setArray(t,e))}}))},data:function({selector:t,data:e,elements:n,passTo:a}){t?this.render(t,e):n&&this.setValue(n,e,a)},render:function(t,e){let n=document.querySelector(t);n&&(Array.isArray(e)?(n.setAttribute("data-render_array","test"),this.setValue([n],{test:e})):this.setValue(n.children,e))}}},15452:function(t,e){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(t){function e(){let e={};return t&&t.config&&(e=t.config),{apiKey:e.apiKey,securityKey:e.securityKey,organization_id:e.organization_Id}}function n(e){let n={};return t&&t.config&&(n=t.config),{apiKey:e.apiKey||n.apiKey,securityKey:e.securityKey||n.securityKey,organization_id:e.organization_id||n.organization_Id}}function a(e,n){let a={};t&&t.config&&(a=t.config);let i=e||a.organization_Id,r=n||"";return r?`${i}/${r}`:i}function i(t=36){let e=(new Date).getTime(),n=0,a="uxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";if(t<=a.length)a=a.substr(0,t);else{let e=t-a.length,n="-xxxyyxxx",i=Math.floor(e/n.length);for(let t=0;t<i;t++)a+=n;i=e-i*n.length,a+=n.substr(0,i)}return a.replace(/[xy]/g,(function(t){var a=16*Math.random();return e>0?(a=(e+a)%16|0,e=Math.floor(e/16)):(a=(n+a)%16|0,n=Math.floor(n/16)),("x"==t?a:7&a|8).toString(16)}))}return{getCommonParams:e,getCommonParamsExtend:n,generateSocketClient:a,GenerateUUID:i}}(window)}.apply(e,[]))||(t.exports=n)},64716:function(t,e,n){var a,i;"undefined"!=typeof self&&self,a=[n(15452)],void 0===(i=function(t){return function(t,e,n,a){class i{constructor(t="crud"){this.prefix=t||"crud",this.sockets=new Map,this.listeners=new Map,this.messageQueue=new Map,this.saveFileName="",this.globalScope=""}setGlobalScope(t){this.globalScope=`${this.prefix}/${t}`}getGlobalScope(){return this.globalScope}create(t){const{namespace:i,room:r}=t,o=this.getKey(i,r);let s,l=this;if(i&&this.setGlobalScope(i),this.sockets.get(o))return void(s=this.sockets.get(o));let c=e.location.protocol;"about:"===e.location.protocol&&(c=e.parent.location.protocol,t.host||(t.host=e.parent.location.host));let u="http:"===c?"ws":"wss";const d=t.port?t.port:8088;let f=`${u}://${e.location.host}:${d}/${o}`;t.host&&(f=t.host.includes("://")?`${t.host}/${o}`:t.host.includes(":")?`${u}://${t.host}/${o}`:`${u}://${t.host}:${d}/${o}`);try{s=new n(f)}catch(t){return}s.onopen=function(t){(l.messageQueue.get(o)||[]).forEach((t=>s.send(JSON.stringify(t)))),l.sockets.set(o,s),l.messageQueue.set(o,[])},s.onclose=function(e){switch(e.code){case 1e3:break;default:l.destroy(s,o),l.reconnect(s,t)}},s.onerror=function(e){l.destroy(s,o),l.reconnect(s,t)},s.onmessage=function(t){try{if(e.Blob&&t.data instanceof a)return void l.saveFile(t.data);let i=JSON.parse(t.data);if(i.data.event){if(e.CustomEvent){var n=new e.CustomEvent(i.data.event,{detail:i.data});return void e.document.dispatchEvent(n)}return void process.emit(i.data.event,i.data)}i.action;const r=l.listeners.get(i.action);if(!r)return;r.forEach((t=>{t(i.data,o)}))}catch(t){}}}send(e,n,a){const i={action:e,data:{...n,uid:t.GenerateUUID()}},r=this.getKeyByRoom(a),o=this.getByRoom(a);o?o.send(JSON.stringify(i)):this.messageQueue.get(r)?this.messageQueue.get(r).push(i):this.messageQueue.set(r,[i])}sendFile(t,e){const n=this.getByRoom(e);n&&n.send(t)}listen(t,e){this.listeners.get(t)?this.listeners.get(t).push(e):this.listeners.set(t,[e])}reconnect(t,e){let n=this;setTimeout((function(){n.create(e)}),1e3)}destroy(t,e){t&&(t.onerror=t.onopen=t.onclose=null,t.close(),t=null),this.sockets.get(e)&&this.sockets.delete(e)}destroyByKey(t){let e=this.sockets.get(t);e&&this.destroy(e,t)}getKey(t,e){let n=`${this.prefix}`;return t&&""!=t&&(n+=e&&""!=e?`/${t}/${e}`:`/${t}`),n}getByRoom(t){let e=this.getKeyByRoom(t);return this.sockets.get(e)}getKeyByRoom(t){let e=this.globalScope;return t&&(e=`${this.prefix}/${t}`),e}saveFile(t){if(e.document){const a=this.saveFileName||"downloadFile";var n=e.document.createElement("a");e.document.body.appendChild(n),n.style="display: none";let i=window.URL.createObjectURL(t);n.href=i,n.download=a,n.click(),e.URL.revokeObjectURL(i),this.saveFileName=""}}listenAsync(t){return new Promise(((n,a)=>{e.document?e.document.addEventListener(t,(function(t){n(t.detail)}),{once:!0}):process.once(t,(t=>{n(t)}))}))}}return i}(t,window,WebSocket,Blob)}.apply(e,a))||(t.exports=i)},31159:(t,e,n)=>{"use strict";function a(t=36){let e=(new Date).getTime(),n=window.performance&&window.performance.now&&1e3*window.performance.now()||0,a="uxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";if(t<=a.length)a=a.substr(0,t);else{let e=t-a.length,n="-xxxyyxxx",i=Math.floor(e/n.length);for(let t=0;t<i;t++)a+=n;i=e-i*n.length,a+=n.substr(0,i)}return a.replace(/[xy]/g,(function(t){var a=16*Math.random();if(e>0){a=(e+a)%16|0;e=Math.floor(e/16)}else{a=(n+a)%16|0;n=Math.floor(n/16)}return("x"==t?a:7&a|8).toString(16)}))}function i(t,e,n){if(e){if(t.classList.contains(e))return t;let n=t.parentNode;for(;null!=n&&n.classList;){if(n.classList.contains(e))return n;n=n.parentNode}}else if(n){if(n.every((e=>t.attributes.hasOwnProperty(e))))return t;let e=t.parentNode;for(;null!=e&&e.attributes;){if(n.every((t=>e.attributes.hasOwnProperty(t))))return e;e=e.parentNode}}return!1}function r(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e}catch(t){return!1}}function o(t){return t.getAttributeNames().reduce(((e,n)=>(e[n]=t.getAttribute(n),e)),{})}function s(t){return!!t&&!/{{\s*([\w\W]+)\s*}}/g.test(t)}function l(t){let e=[{document,window}];for(let t of document.querySelectorAll("iframe")){let n=t.contentDocument||t.contentWindow.document,a=t.contentWindow;e.push({document:n,window:a,frameElement:t})}let n=new Set;for(let a of e){let e=t(a);e&&"function"==typeof e[Symbol.iterator]?e.forEach((t=>n.add(t))):e&&n.add(e)}return Array.from(n)}function c(t){let e=[];do{if(!t||!t.tagName)return!1;let n=t.tagName.toLowerCase();if(t.id&&"BODY"!==t.tagName&&(n+="#"+t.id),t.classList.length&&"BODY"!==t.tagName&&t.classList.forEach((t=>{-1===t.indexOf(":")&&(n+="."+t)})),"BODY"!==t.tagName&&t.parentNode){let e=Array.prototype.indexOf.call(t.parentNode.children,t);n+=`:nth-child(${e+1})`}e.unshift(n),t=t.parentNode}while("HTML"!==t.tagName);return e.join(" > ")}function u(){let t=window;for(;t!==window.parent;)t=window.parent;return t}function d(t,e){let n;return l((t=>{t.document.contains(e)&&(n=t.frameElement)})),n}function f(t){let e=u;return t.forEach((t=>{e&&(e=e.querySelector(t))})),e}function*m(t,e){for(let n of t)n.selector&&e.matches(n.selector)&&(yield n)}function h(t,e,n,a){for(let i of m(a||window.elementConfig,t)){if(!0===i[e])return n(t,i);if(!1===i[e])return!1;if(void 0===i[e])continue;if(y(i[e]))return n(t,i,!0)}return!1}function _(t=10){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",a=n.length,i=0;i<t;i++)e+=n.charAt(Math.floor(Math.random()*a));return e+=(new Date).toTimeString().replace(/[\W_]+/g,"").substr(0,6)}function g(t){let e=(new DOMParser).parseFromString(t,"text/html");return e.head.children[0]?e.head.children[0]:e.body.children[0]}function p(t,e){return t.split(e).map((t=>t.trim()))}function b(t,e){return t.map((t=>t.trim())).join(e)}function y(t){try{document.createDocumentFragment().querySelector(t)}catch(t){return!1}return!0}function A(t,e){let n=[],a=(window,d(0,t)),i=c(a);return i&&n.unshift(i),e?{path:n,document:a||document}:n}n.r(e),n.d(e,{generateUUID:()=>a,getParentFromElement:()=>i,isJsonString:()=>r,getAttributes:()=>o,checkValue:()=>s,allFrame:()=>l,cssPath:()=>c,getTopMostWindow:()=>u,findIframeFromElement:()=>d,getIframeFromPath:()=>f,configMatch:()=>m,configExecuter:()=>h,UUID:()=>_,parseTextToHtml:()=>g,splitBydelimiter:()=>p,joinBydelimiter:()=>b,isValidSelector:()=>y,getElementPath:()=>A,default:()=>v});const v={getElementPath:A,isValidSelector:y,joinBydelimiter:b,splitBydelimiter:p,parseTextToHtml:g,UUID:_,configExecuter:h,configMatch:m,getIframeFromPath:f,findIframeFromElement:d,getTopMostWindow:u,cssPath:c,allFrame:l,checkValue:s,getAttributes:o,isJsonString:r,getParentFromElement:i,generateUUID:a}},78054:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=c(n(97636)),i=c(n(84600)),r=c(n(31159)),o=c(n(72612)),s=c(n(67924)),l=c(n(3852));function c(t){return t&&t.__esModule?t:{default:t}}const u={selector:"[data-template_id][data-fetch_collection]",items:[],init:function(){this.initElement(),this.__initSocketEvent(),this.__initEvents()},initElement:function(t){let e=t||document;const n=this;if(!e.querySelectorAll)return;let a=e.querySelectorAll(this.selector);0==a.length&&e!=document&&e.hasAttribute("data-template_id")&&e.hasAttribute("data-fetch_collection")&&(a=[e]),a.forEach((t=>{n.__initEachElement(t,!0,!0)}))},refershElement:function(t){const{target:e}=t;e&&e.hasAttribute("data-fetch_collection")&&this.__initEachElement(e,!1,!1,!0)},reload:function(t){},__initSocketEvent:function(){const t=this;o.default.listen("readDocumentList",(function(e){t.__fetchedItem(e)})),o.default.listen("readCollectionList",(function(e){t.__fetchedItem(e)})),o.default.listen("createDocument",(function(e){t.__createItem(e)})),o.default.listen("deleteDocument",(function(e){t.__deleteItem(e)}))},__initEvents:function(){const t=this;window.addEventListener("dndsuccess",(function(e){const{dropedEl:n,dragedEl:a}=e.detail;let i=a.getAttribute("data-template_id"),r=document.querySelector(`[data-fetch_collection][data-template_id='${i}']`),o=t.findTemplateElByChild(n);r&&o&&(r.isSameNode(o)||(t.updateParentTemplateOfChild(o,a),t.reorderChildrenOfTemplate(r)),t.reorderChildrenOfTemplate(o))}))},__initEachElement:function(t,e,n,r){let o=t.getAttribute("data-template_id");if(!o)return;if(!t.getAttribute("data-fetch_collection"))return;if(a.default.getInitialized(t,"fetch")&&e)return;let s=i.default.getObjectByFilterId(this.items,o),l=null;const c=this;if(!e||!s){if(a.default.setInitialized(t,"fetch"),s)l=s.filter,i.default.changeCollection(l),r&&(s.filter.isRefresh=!0,c.__removeOldData(t),l.isRefresh=!0,l.startIndex=0);else{l=i.default.setFilter(t,"data-template_id","template");let e=t.getAttribute("data-fetch_value_type")||"string";if(!l)return;"collection"===e&&(l.is_collection=!0),s={el:t,filter:l,templateId:o,fetch_type:e},this.items.push(s),t.addEventListener("changeFilterInput",(function(t){c.__removeOldData(s.el),s.filter.startIndex=0,s.filter.isRefresh=!0,i.default.fetchData(s.filter)}))}i.default.fetchData(l)}},__runLoadMore:function(t){if(!t)return;let e=i.default.getObjectByFilterId(this.items,t);e&&e.filter.count>0&&i.default.fetchData(e.filter)},__removeOldData:function(t){let e=t.getAttribute("data-template_id");t.querySelectorAll("[templateId='"+e+"']").forEach((t=>t.remove()))},__cloneElement:function(t,e,n){let a=document.createElement(t.parentNode.tagName||"div"),i=t.cloneNode(!0);return i.setAttribute("templateId",e),n||(n="data"),i.getAttribute("data-render_array")||i.setAttribute("data-render_array",n),a.appendChild(i.cloneNode(!0)),a},__renderData:function(t,e,n="data"){let a=t.getAttribute("data-template_id"),i=t.querySelector(`.template[data-template_id='${a}'`);if(!i)return;let r=t.getAttribute("data-render_id"),o=t.getAttribute("data-pass_to"),c=r?{[r]:e}:e;n=n||"data",n=r?`${r}.${n}`:n;let u=this.__cloneElement(i,a,n);l.default.data({elements:u.children,data:c,passTo:o});let d=u.querySelector(`.template[data-template_id="${a}"]`);if(!d)return;d.remove(),i.insertAdjacentHTML("beforebegin",u.innerHTML);var f=new CustomEvent("fetchedTemplate",{bubbles:!0});t.dispatchEvent(f);let m=t.parentNode.getElementsByTagName("form");for(let t=0;t<m.length;t++){let e=m[t],n=e.querySelector(".passValueBtn");n&&s.default.__registerValuePassBtnEvent(e,n)}},__deleteItem:function(t){let e=t.collection,n=t.document_id;for(let t=0;t<this.items.length;t++){let r=this.items[t];if(r.filter.collection==e){var a=r.el.getAttribute("data-template_id"),i=r.el.querySelectorAll("[templateId='"+a+"'][data-document_id='"+n+"']");for(let t=0;t<i.length;t++)i[t].remove(),r.startIndex--}}},__fetchedItem:function(t){let e=t.element,n=i.default.getObjectByFilterId(this.items,e);if(n){n.filter.startIndex+=t.data.length;let e=n.el.getAttribute("data-fetch_name");e&&(t=t.data[0]),t&&(t.metadata&&t.metadata.isRefresh&&this.__removeOldData(n.el),this.__renderData(n.el,t,e))}},__createItem:function(t){let e=t.collection;const n=this;let a=t.data,i=t;i.data=[a],this.items.forEach((t=>{const{filter:r}=t;t.fetch_ids=[],r.collection===e&&!t.el.getAttribute("data-fetch_name")&&n.__checkItemByFilters(a,r.filters)&&n.__renderData(t.el,i)}))},findTemplateElByChild:function(t){return r.default.getParentFromElement(t,null,["data-template_id","data-fetch_collection"])},updateParentTemplateOfChild:function(t,e){const n=t.getAttribute("data-filter_name"),a=t.getAttribute("data-filter_value"),i=t.getAttribute("data-filter_operator");n&&"$eq"==i&&o.default.updateDocument({collection:t.getAttribute("data-fetch_collection"),document_id:e.getAttribute("data-document_id"),data:{[n]:a},broadcast:!1})},reorderChildrenOfTemplate:function(t){const e=t.getAttribute("data-order_by"),n=t.getAttribute("data-template_id");if(!e||!n)return;const a=t.querySelectorAll(`[data-template_id="${n}"][data-document_id]:not(.template)`),i="asc"!==t.getAttribute("data-order_type")?-1:1;a.forEach(((n,a)=>{n.classList.contains("template")||o.default.updateDocument({collection:t.getAttribute("data-fetch_collection"),document_id:n.getAttribute("data-document_id"),data:{[e]:a*i},broadcast:!1})}))},__checkItemByFilters:function(t,e){let n=!0;return!(!t||!e)&&(!Array.isArray(t)&&(e.forEach((({name:e,operator:a,type:i,value:r})=>{const o=t[e];if(n)switch(a){case"$contain":Array.isArray(o)&&o.some((t=>r.includes(t)))||(n=!1);break;case"$range":null!==r[0]&&null!==r[1]?(r[0]>o||r[1]<=o)&&(n=!1):(null==t.value[0]&&r[1]>=o||null==t.value[1]&&r[0]<=o)&&(n=!1);break;case"$eq":o!=r[0]&&(n=!1);break;case"$ne":null!=o&&o!=r[0]||(n=!1);break;case"$lt":o>=r[0]&&(n=!1);break;case"$lte":o>r[0]&&(n=!1);break;case"$gt":o<=r[0]&&(n=!1);break;case"$gte":o<r[0]&&(n=!1);break;case"$in":Array.isArray(o)&&o.some((t=>r.includes(t)))||(n=!1);break;case"$nin":Array.isArray(o)&&o.some((t=>r.includes(t)))&&(n=!1)}})),n))}};a.default.init({name:"CoCreateFetchObserver",observe:["attributes"],attributes:["data-fetch_collection","data-filter_name"],callback:function(t){u.refershElement(t)}}),a.default.init({name:"CoCreateFetchInit",observe:["subtree","childList"],include:"[data-fetch_collection]",callback:function(t){u.initElement(t.target)}}),u.init();var d=u;e.default=d}}]);
(this.webpackChunkCoCreate=this.webpackChunkCoCreate||[]).push([[247],{9247:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});var a={selector:".progress-wrapper",mainObjects:[],init:function(){this.initElement(),this.initEvent()},initElement:function(t){let e=(t||document).querySelectorAll(this.selector),r=this;e.forEach((t=>{let e=CoCreate.filter.setFilter(t,"data-progress_id","progress");if(!e)return;let a={el:t,filter:e,id:t.getAttribute("data-progress_id")};r.mainObjects.push(a),r.fetchProgess(t)}))},initEvent:function(){let t=this;CoCreate.socket.listen("readDocumentList",(function(e){"progress-total"==e.metadata?t.renderProgress(e,!0):"progress-value"==e.metadata&&t.renderProgress(e,!1)}))},renderProgress(t,e){if(!t)return;const r=t.element;if(!r)return;const a=t.data.length;let s=this,o=[],i=e?".progressTotal":".progressValue";i+=`[data-progress_id="${r}"]`,o=document.querySelectorAll(i),o.forEach((t=>{t.textContent=a})),o=document.querySelectorAll(`.progressbar[data-progress_id="${r}"]`),o.forEach((t=>{"PROGRESS"===t.tagName?e?t.setAttribute("max",a):t.setAttribute("value",a):(e?t.setAttribute("data-total",a):t.setAttribute("data-value",a),s.renderBar(t))}))},renderBar:function(t){const e=Number(t.getAttribute("data-total")),r=Number(t.getAttribute("data-value"));if(!e||!r||0===e)return;const a=r/e*100;t.innerHTML=`<div style="width: ${a}%"></div>`},fetchProgess:function(t){let e=null,r=t.getAttribute("data-progress_id");if(this.mainObjects.forEach((t=>{t.id==r&&(e=t)})),!e)return;let a=e.filter,s=CoCreate.filter.makeFetchOptions(a),o=CoCreate.filter.makeFetchOptions(a),i=t.getAttribute("data-progress_name"),n=t.getAttribute("data-progress_value"),u=t.getAttribute("data-progress_operator")||"contain";s.metadata="progress-total",o.metadata="progress-value";let l=[].concat(o.operator.filters);l.push({name:i,value:[n],operator:u}),o.operator.filters=l,CoCreate.crud.readDocumentList(s),CoCreate.crud.readDocumentList(o)}};a.init();const s=a}}]);
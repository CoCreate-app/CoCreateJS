(this.webpackChunkCoCreate=this.webpackChunkCoCreate||[]).push([[837],{3072:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>n});var i=s(4752);function r(t,e,s,r,a){s?i.default.insertText({...t,value:s,position:r}):i.default.deleteText({...t,position:r,length:a-r})}String.prototype.replaceAt=function(t,e){return this.substr(0,t)+e+this.substr(t)},String.prototype.removeAt=function(t,e){return this.substr(0,t)+this.substr(e)};function a({html:t,tagName:e,target:s,method:i,property:r,nextSibling:a,skip:n}){e=e.toLowerCase(),this.getRegAttribute=t=>`(?:${h}${t}(?:="[^"]*?")?${l})`,this.getRegStyle=t=>`(?:${l}${t}${l}:${l}[^;]+?${l};${l})`,this.getRegClass=t=>`(?:${l}${t}${l})`,this.getTagClose=t=>`(?:${l}/${l}${t}${l})`,this.getRegTagStart=t=>`(?:<${t}${l})`;let o="(?: |\t|\n|\f|\r)",g=`[^${o}=>]+`,l=`${o}*?`,h=`${o}+?`,u=this.getRegAttribute(g),m=`(?:<(?<tagName>[a-z0-9]+?)${l})`,f=`(?:${l}data-element_id="${s}"${l})`,c=this.getRegStyle("[^:]+?"),d=(this.getRegClass('[^"]+?'),`(?<closeTag>>${e.split("").reverse().join("")}${l}/${l}<)`);this.findStartTag=t=>{let s=`(?<tagWhole>${m}${u}*?${f}${u}*?(?<tagSlash>/)?>)`,i=t.match(new RegExp(s,"is"));if(!i)throw new Error("findPosition: element can not be found");if(i&&e&&i.groups.tagName.toLowerCase()!==e)throw new Error("findPosition: tag name didn't match, something is wrong");this.tagName=i.groups.tagName.toLowerCase(),this.tagStPos=i.index,this.tagStAfPos=i.index+e.length+1,this.tagStClPos=i.index+i.groups.tagWhole.length-1-(i.groups.tagSlash?1:0),this.tagStClAfPos=i.index+i.groups.tagWhole.length,i.groups.tagSlash&&(this.tagEnPos=this.tagStClPos,this.tagEnClAfPos=this.tagStClAfPos)},this.tagStPos,this.tagStAfPos,this.tagStClPos,this.tagStClAfPos,this.tagEnPos,this.tagEnClPos,this.atSt,this.atEn,this.tagEnPos,this.tagEnClAfPos,this.lastStart,this.offset,this.getWholeElement=()=>(this.tagStPos||this.findStartTag(t),this.tagEnPos||this.findClosingTag(),{from:this.tagStPos,to:this.tagEnClAfPos}),this.findClosingTag=()=>{let e,s=t.split("").reverse().join("");if(a){if(e=s.indexOf(`"${a.split("").reverse().join("")}"=di_tnemele-atad `),-1===e)throw new Error("could not found next sibiling "+a+" in the html");s=s.substr(e)}let i=s.matchAll(new RegExp(d,"isg")),r=Array.from(i)[n];if(!r)throw new Error("couldn't find the end tag");this.tagEnClAfPos=t.length-r.index-e,this.tagEnPos=this.tagEnClAfPos-r[0].length},this.getInsertAdjacentElement=e=>{switch(this.tagStPos||this.findStartTag(t),e){case"beforebegin":return{from:this.tagStPos};case"afterbegin":return{from:this.tagStClAfPos};case"beforeend":return this.findClosingTag(),{from:this.tagEnPos};case"afterend":return this.findClosingTag(),{from:this.tagEnClAfPos}}t.substr(this.tagStClAfPos)},this.getClass=(e,s)=>{if(this.findAttribute(t,"class",!0),this.atEn){return{...this.findClassPos(t,e),context:"value"}}return{from:this.atSt,context:"attribute"}},this.findClassPos=(t,e)=>{let s=this.getRegClass(e),i=t.substring(this.atSt,this.atEn).match(new RegExp(`(?<ourClass>${s})(?<classstyle>:[^" ]+)( |")?`,"is"));return i&&i.groups.ourClass?{from:this.atSt+i.index,to:this.atSt+i.index+i.groups.ourClass.length+i.groups.classstyle.length}:{from:this.atEn}},this.getStyle=(e,s)=>{if(this.findAttribute(t,"style",!0),this.atSt===this.atEn)return{from:this.atSt,context:"value"};if(this.atEn){return{...this.findStylePos(t,e),context:"value"}}return{from:this.atSt,context:"attribute"}},this.findStylePos=(t,e)=>{let s=this.getRegStyle(e),i=t.substring(this.atSt,this.atEn).match(new RegExp(`^(?<styleWhole>${c})*?(?<ourStyle>${s})`,"is"));if(i&&i.groups.ourStyle){let t=i.groups.styleWhole?i.groups.styleWhole.length:0;return{from:this.atSt+t,to:this.atSt+t+i.groups.ourStyle.length}}return{from:this.atEn}},this.findAttribute=(t,e,s)=>{this.tagStAfPos||this.findStartTag(t);let i=this.getRegAttribute(e),r=`^(?<beforeAtt>${u}*?)${i}`,a=t.substr(this.tagStAfPos).match(new RegExp(r,"is"));a?(this.atSt=this.tagStAfPos+a.groups.beforeAtt.length+(s?3+e.length:0),this.atEn=this.tagStAfPos+a[0].length-(s?1:0)):this.atSt=this.tagStClPos},this.getSetAttribute=(e,s)=>{switch(s){case"get":case"set":this.findAttribute(t,e,!0);break;case"remove":this.findAttribute(t,e)}return{from:this.atSt,to:this.atEn}},this.getInnerText=function(e){return this.tagStPos||this.findStartTag(t),this.findClosingTag(),{from:this.tagStClAfPos,to:this.tagEnPos}},this.scanMethods=()=>{switch(i){case"insertAdjacentElement":return this.getInsertAdjacentElement(r);case"class":return this.getClass(r);case"innerText":return this.getInnerText(r);case"style":return this.getStyle(r);case"setAttribute":return this.getSetAttribute(r,"set");case"getAttribute":return this.getSetAttribute(r,"get");case"removeAttribute":return this.getSetAttribute(r,"remove");case"removeElement":return this.getWholeElement();default:throw new Error("findPosition: method is not supported")}};let p=this.scanMethods();return function(t){t.to}(p),p}const n={getNextSibling:function(t){let e=0,s=t.tagName;for(;t&&!t.nextElementSibling;)(t=t.parentElement)&&t.tagName===s&&e++;return t?[t.nextElementSibling.getAttribute("data-element_id"),e]:[void 0,void 0]},domToText:function(t){try{let e,s,n,{name:o,document_id:g,collection:l}=t,h={name:o,document_id:g,collection:l},u=i.default.getText(h);switch(t.method){case"innerText":e=new a({html:u,target:t.target,tagName:t.tagName,nextSibling:t.nextSibling,skip:t.skip,method:"innerText"}),u=r(h,0,t.value,e.from,e.to);break;case"removeElement":e=new a({html:u,target:t.target,tagName:t.tagName,nextSibling:t.nextSibling,skip:t.skip,method:"removeElement"}),u=r(h,0,null,e.from,e.to);break;case"insertAdjacentElement":s=new a({html:u,tagName:t.target.tagName,target:t.target.target,nextSibling:t.target.nextSibling,skip:t.target.skip,method:"insertAdjacentElement",property:t.property}),t.element.value?n=t.element.value:(e=new a({html:u,tagName:t.element.tagName,target:t.element.target,nextSibling:t.element.nextSibling,skip:t.element.skip,method:"removeElement"}),n=u.substring(e.from,e.to),s.from>=e.to&&(s.from-=e.to-e.from),u=r(h,0,null,e.from,e.to)),u=r(h,0,n,s.from);break;case"style":e=new a({html:u,target:t.target,tagName:t.tagName,property:t.property,method:"style"});let i=` ${t.property}:${t.value}${t.unit||""};`;if("attribute"==e.context)n=` style="${i}"`;else if("value"==e.context){if(e.to&&!t.value)return void(u=r(h,0,null,e.from,e.to));n=i,e.to&&(u=r(h,0,null,e.from,e.to))}u=r(h,0,n,e.from);break;case"classstyle":e=new a({html:u,target:t.target,tagName:t.tagName,property:t.property,method:"class"}),n=` ${t.property}:${t.value}${t.unit||""}`,"attribute"==e.context?(n=` class="${n}"`,u=r(h,0,n,e.from)):"value"==e.context&&(e.to&&(u=r(h,0,null,e.from,e.to)),t.value&&(u=r(h,0,n,e.from)));break;case"class":if(e=new a({html:u,target:t.target,tagName:t.tagName,property:t.property,method:"class"}),n=` ${t.property}`,"attribute"==e.context)n=` class="${n}"`,u=r(h,0,n,e.from);else if("value"==e.context){if(e.to&&!t.value)return void(u=r(h,0,null,e.from,e.to));t.value&&(u=r(h,0,n,e.from))}break;case"setAttribute":e=new a({html:u,target:t.target,tagName:t.tagName,property:t.property,method:"setAttribute"}),t.value?e.to?(u=r(h,0,null,e.from,e.to),u=r(h,0,t.value,e.from)):u=r(h,0,` ${t.property}="${t.value}"`,e.from):e.to&&(e=new a({html:u,target:t.target,tagName:t.tagName,property:t.property,method:"removeAttribute"}),u=r(h,0,null,e.from,e.to));break;case"removeAttribute":u=r(h,0,null,e.from,e.to)}}catch(t){}},findPositionFunc:a}}}]);